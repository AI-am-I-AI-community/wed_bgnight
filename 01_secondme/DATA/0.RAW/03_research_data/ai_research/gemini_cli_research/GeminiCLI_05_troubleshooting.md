# GeminiCLI - トラブルシューティング

## 初回起動時のエラー

### エラー内容
```
Error processing directory "/Users/masaya": EPERM: operation not permitted, scandir '/Users/masaya/.Trash'
```

### 原因
- macOSのセキュリティ機能により、プログラムがユーザーのゴミ箱フォルダ（.Trash）の中身を覗き見ることが標準で許可されていない
- GeminiCLIが現在の作業ディレクトリの中身を把握しようとした際に発生

### 影響
- ゴミ箱の中身を見ることができないだけで、他の開発関連のフォルダやファイルには問題なくアクセス可能
- OSの正常なセキュリティ機能によるもので、特に問題はない

## iCloudファイルへのアクセス問題

### 問題
- iCloudのパスは特殊で、ツールがうまく認識してくれない時がある
- 標準的なiCloud Driveのパス: `/Users/masaya/Library/Mobile Documents/`

### 解決方法
1. **パスの確認**: まず正確なパスを特定する
2. **glob検索の活用**: `**/*.md` などのパターンでファイルを検索
3. **絶対パスの使用**: 相対パスではなく絶対パスを指定

### 実際の例
```
# 失敗例
read_many_files で相対パスを指定

# 成功例  
glob を使って絶対パスでリストアップしてから read_many_files に渡す
```

## ファイル読み込みの最適化

### 課題
- 大量のファイル（38個のマークダウンファイル）を効率的に読み込む必要がある

### 解決策
1. **段階的アプローチ**:
   - まず `glob` でファイル一覧を取得
   - 次に `read_many_files` で一括読み込み

2. **パスの工夫**:
   - iCloudの特殊なパス構造を考慮
   - 絶対パスを使用して確実性を高める

### 成功例
```
✔ FindFiles '**/*.md' within ...rary/Documents/Obsidian_iCloud/00_core
Found 38 matching file(s)

✔ ReadManyFiles 
Successfully read and concatenated content from **38 file(s)**.
```

## メモリ機能の制限

### save_memory ツールの制限
- **目的**: 短く具体的な事実のみを保存
- **制限**: 長文のドキュメントや複数ファイルの一括インポートには不適切
- **比喩**: たくさんの本を丸ごと1つの単語として覚えようとするようなもの

### 最適な使用方法
- ペルソナの核となるエッセンス（11項目）を厳選して保存
- 詳細な情報は短期記憶（セッションコンテキスト）を活用

## パフォーマンス最適化

### 大量ファイル処理
- 38個のファイルを一度に処理する際の効率化
- `read_many_files` を使用した一括処理

### セッション管理
- 短期記憶の活用：大量の情報を一時的に保持
- 長期記憶の活用：重要な事実を永続的に保存

## 一般的なベストプラクティス

1. **パス指定**: 絶対パスを使用して確実性を高める
2. **段階的処理**: glob → read_many_files の順序で処理
3. **エラーハンドリング**: macOSのセキュリティ制限を考慮
4. **メモリ使い分け**: 短期記憶と長期記憶の特性を理解して使い分ける 