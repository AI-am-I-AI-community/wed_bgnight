# 開発中の技術的課題メモ

## 📅 更新日: 2025-01-07

## 🚧 現在の課題

### 1. Sanity API キー管理問題

**問題の詳細:**
- VercelにSanity APIキーを設定すると、GitHub経由でのデプロイ・本番環境では正常動作 ✅
- しかし、ローカル環境の`.env.local`ファイルにAPIキーを保存しても、Cursorが読み込めない ❌
- そのため、ローカルでのプレビュー確認ができない状態

**現在の状況:**
- 本番サイト: https://website-nu-self-61.vercel.app/ ✅ 正常動作
- ローカル開発: ❌ Sanity API接続失敗
- Sanity Studio: http://localhost:3333 ❌ アクセス不可

**影響範囲:**
- ローカル開発時のプレビュー確認不可
- Sanity Studioでのコンテンツ管理確認不可
- 開発効率の低下

**試行した解決策:**
1. `.env.local`ファイル作成・編集 → 失敗
2. nano/テキストエディタでの手動編集 → アクセス問題
3. 複数の環境変数設定方法 → 未解決

**現在の対処法:**
- GitHub経由でのデプロイによる本番確認
- コード内配列でのブログ記事管理継続

---

## 🎯 今後の対応方針

### 短期的対応 (優先度: 高)
1. **現在の方式継続**: コード内配列でブログ記事管理
2. **本番環境での確認**: GitHub → Vercel自動デプロイ活用
3. **Sanity問題は一旦保留**: 時間効率を優先

### 中長期的対応 (優先度: 中)
1. **ローカル環境問題の根本解決**
   - Cursor + macOS環境での.env.local読み込み問題調査
   - 代替的なAPIキー管理方法検討
2. **Sanity Studio活用再開**
   - ローカル問題解決後のコンテンツ管理移行
   - ハイブリッド運用（Sanity確認 + コード管理）

---

## 💡 学んだこと

1. **環境構築の複雑さ**: 理論上可能でも実環境では予期しない問題が発生
2. **優先順位の重要性**: 完璧を求めすぎず、動くものを優先する判断
3. **代替手段の価値**: 複数のアプローチを持つことの重要性

---

## 📋 関連ファイル

- `website/.env.local` - 環境変数設定（問題のファイル）
- `website/scripts/sync-to-sanity.js` - Sanity同期スクリプト
- `website/src/app/page.tsx` - 現在動作中のメインページ
- `sanity-studio/q/` - Sanityプロジェクトディレクトリ

---

## 🔧 技術スタック状況

### ✅ 正常動作
- Next.js 14 + TypeScript
- Tailwind CSS
- Vercel デプロイ
- GitHub 連携

### ⚠️ 部分的動作
- Sanity CMS (本番のみ)

### ❌ 動作不良
- ローカル Sanity Studio
- ローカル環境変数読み込み 