---
title: "タスクを一度視覚化して取り組ませることで、LLMの推論能力を大きく向上させるプロンプト手法『Whiteboard-of-Thought（ホワイトボード思考法）』"
source: "https://ai-data-base.com/archives/71633"
author:
  - "[[AIDB Research]]"
published: 2024-06-25
created: 2025-06-13
description: "複雑な問題に直面したとき、私たちは心の中でイメージを描いたり、紙にスケッチを描いたりして考えを整理します。"
tags:
  - "clippings"
---
**【お知らせ】** AIDB主催のビジネスマッチングイベントを7月25日(金)開催予定です！  
  

\---以下、記事本文---

複雑な問題に直面したとき、私たちは心の中でイメージを描いたり、紙にスケッチを描いたりして考えを整理します。今回、コロンビア大学の研究チームは、こうした能力をLLMに組み込むべく、「Whiteboard-of-Thought（ホワイトボード思考法）」という手法を開発しました。

![](https://ai-data-base.com/wp-content/uploads/2024/06/AIDB_71633-1024x576.jpg)

**参照論文情報**

- タイトル：Whiteboard-of-Thought: Thinking Step-by-Step Across Modalities
- 著者：Sachit Menon, Richard Zemel, Carl Vondrick
- 所属：Columbia University

## 背景

LLMに複雑な推論を必要とするタスク（例えば算術など）においては、「思考の連鎖」（Chain-of-Thought）と呼ばれる手法がよく使用されます。「ステップバイステップで考えましょう」などといった指示によりLLMに問題解決のプロセスを文章化させることで、より正確な答えを導き出すことを可能にする手法です。

一方で、人間のような視覚に基づく思考や空間的推論に関しては、LLMの性能はまだ十分ではないことが指摘されています。例えば、自然言語で記述された空間的な指示を理解したりすることは、LLMにとって難しいタスクであると言われています。  
画像も扱えるマルチモーダルLLMも発展していますが、視覚的な推論を行う能力はまだそれほど進歩していません。

人間が視覚的な問題を解く際には、メンタルイメージを形成したり、図を描いたりすることで思考を補助します。そこで、この人間の認知プロセスにヒントを得て、テキストだけでなく画像も中間推論に活用する新しいアプローチが考案されました。マルチモーダルLLMに「ホワイトボード」のような機能を持たせる手法です。

以下で詳しく紹介します。

※なお本稿ではWhiteboard-of-Thought（WoT）のことをホワイトボード思考法と表記していますが、論文で公式に訳されているものではなく、編集部による独自の訳になります。

![](https://ai-data-base.com/wp-content/uploads/2024/06/AIDB_71633_1-1024x731.jpg)

視覚的推論が必要なクエリに対して、従来の思考の連鎖（CoT）が失敗する一方、ホワイトボード思考法が成功する例を示しています。

## 前提知識

まず今回の研究における基礎を並べます。

### マルチモーダルLLM

マルチモーダルLLMは、LLMの能力を拡張し、テキストだけでなく画像などの他の形式の入力も処理できるように設計されています。画像キャプション生成や視覚的質問応答など、視覚と言語を組み合わせたタスクで優れた性能を発揮することが期待されています。

### 思考の連鎖プロンプティング

複雑な推論タスクにおいて、LLMの性能を向上させる手法として「思考の連鎖」（Chain-of-Thought、CoT）プロンプティングがあります。モデルに段階的な推論プロセスを生成させることで、より正確な答えを導き出させる手法です。

CoTプロンプティングには、Few-shot（少数事例）とZero-shot（事例なし）の2種類があります。望ましい推論過程の例をモデルに提示するのがFew-shotのCoTで、前述した「ステップバイステップで考えましょう」といった簡単な指示を与えてモデルに段階的な推論を行わせるのがZero-shotのCoTです。

### ツールの活用

LLMに外部ツールを活用させる試みも行われています。例えば、計算機能を持つ「スクラッチパッド」や、Pythonインタプリタを使用して計算を行うことでLLMは複雑な計算や特定のタスクをより効率的に処理できるようになります。また、APIを呼び出してツールを使用する能力を持つLLMの開発も進められています。

## ホワイトボード思考法（Whiteboard-of-Thought）

マルチモーダルLLMに「ホワイトボード」のような機能を提供し、中間的な推論ステップを視覚化する、というのが今回の手法の主なポイントです。

### 手順

1. システムプロンプトとして次の文を使用します。 **“You write code to create visualizations using the {Matplotlib/Turtle} library in Python, which the user will run and provide as images. Do NOT produce a final answer to the query until considering the visualization.”**
2. ユーザーが視覚的推論を必要とする問題（例：ASCII art認識、空間ナビゲーション）を入力します。
3. マルチモーダルLLMは与えられたクエリに基づいて、MatplotlibやTurtleライブラリを使用した視覚化コードを生成します。
4. 生成されたPythonコードを正規表現を用いてレスポンスから抽出します。
5. Pythonインタープリタで実行し、画像を生成します。
6. 生成された画像に白い境界線を追加し、サイズを調整します。画像フィルターの誤検出を避けるための処理です。
7. 処理された画像を元のクエリとともにマルチモーダルLLMに再度入力します。
8. マルチモーダルLLMは視覚化された情報を考慮して、最終的な回答を生成します。

### 本手法のポイント

1. 事前の例示なし（ゼロショット）で実行できる
2. マルチモーダルLLMの既存の能力（コード生成、画像理解）を活用するため、特別なモジュールや訓練が不要
3. 人間が複雑な問題を解決する際に図や図表を描くプロセスを模倣している

（編集部注：なお、上記の手順を実行できる機能を持つモデルに限定されることも本手法の特徴で、実験ではGPT-4oが使用されています）

### プロンプトの例

**コード生成用プロンプト**

```js
System: You write code to create visualizations using the {Matplotlib/Turtle} library in Python, which the user will run and provide as images. Do NOT produce a final answer to the query until considering the visualization.
（Pythonの{Matplotlib/Turtle}ライブラリを使用してビジュアライゼーションを作成するコードを記述します。ユーザーはそのコードを実行して画像として提供します。ビジュアライゼーションを考慮するまでは、最終的な回答を出さないでください。）

User: [クエリ]

Assistant: To visualize this, I'll create a Python script using the {Matplotlib/Turtle} library. Here's the code:

\`\`\`python
[生成されたPythonコード]
```

**画像理解用プロンプト**

```js
System: Analyze the provided image and answer the original query based on the visualization.
（提供された画像を分析し、ビジュアライゼーションに基づいて元の質問に回答してください。）

User: Original query: [元のクエリ]
Here's the visualization: [画像]

Assistant: Based on the visualization provided, I can now answer the original query.

[最終的な回答と説明]
```

## 実験

ホワイトボード思考法の効果を検証するため、視覚的推論を必要とする2種類の自然言語タスクが実施されました。ASCII文字の理解と空間的ナビゲーションに関するタスクです。

#### 実験設定

全ての実験において、マルチモーダルLLMとして使用されたのはGPT-4o（gpt-4o-2024-05-13）です。コード出力の生成や画像入力の受け取りなど、ホワイトボード思考法に必要な機能を備えているモデルです。

実験はゼロショット（事前の例示なし）の環境で行われ、以下の3つの手法が比較されました。

1. **直接回答（Direct）  
	**モデルに直接答えを生成させる方法
2. **思考の連鎖（Chain-of-Thought、CoT）  
	**段階的な推論プロセスをテキストで生成する方法
3. **ホワイトボード思考法（Whiteboard-of-Thought、WoT）  
	**視覚化を用いた推論を行う方法（今回考案の手法）

#### モデルの設定

初期クエリに対しては、温度（temperature）0（※1）、最大トークン数2048（※2）、top\_p 1（※3）、頻度ペナルティ0.05（※3）、存在ペナルティ0（※4）の設定が使用されました。なお画像クエリに対しては、同様の設定で最大トークン数が256に変更され、頻度ペナルティは適用されませんでした。

※1　温度（temperature）は生成されたトークン（単語や文字）の確率分布を制御するパラメータです。温度が0の場合、最も確率の高いトークンのみが選択され、予測が非常に決定的になります。温度が高いと、より多くのトークンが考慮されるため、生成結果が多様になります。

※2　最大トークン数（maximum tokens）は生成されるトークンの最大数を指定します。今回は2048が設定されており、生成されるテキストの長さが最大2048トークンまでになることを意味します。

※3　top\_pは確率的なトークン選択のためのパラメータです。top\_pが1の場合、確率の高いトークンが累積確率が1になるまで選択されます。最も確率の高いトークンが常に選ばれることを意味します。

※4　頻度ペナルティ（frequency penalty）は生成されたテキスト内で同じトークンが何度も繰り返されるのを防ぐためのパラメータです。今回は0.05が設定されており、トークンの頻度に対してわずかにペナルティが課せられます。

※5　存在ペナルティ（presence penalty）は生成されたテキスト内で新しいトークンが登場する可能性を制御するパラメータです。今回は0が設定されており、生成されるトークンの選択に影響を与えません。

### ASCII（アスキー）理解タスク

ASCII文字で描かれた図形や文字を認識し、理解する能力を評価するタスクで実験されました。  
テキストと視覚的な処理を組み合わせる必要があるため今回のテーマに適したタスクだと考えられました。

### データセットとタスク

BIG-Benchから3つのASCII理解タスクが選択されました。

1. ASCII MNIST数字認識
2. ASCII単語認識
3. ASCII漢字認識

各タスクから250のランダムに選ばれた例が評価に使用されました。

### 視覚化の方法

Matplotlibが視覚化ツールとして使用されました。モデルにはASCII文字列とともに、視覚化のための具体的な指示（図のサイズ設定や色の使用方法など）が与えられました。

### 評価方法

- MNIST数字：生成された答えが整数に変換され、正解と比較されました。
- 単語と漢字：生成された文字列が小文字に変換され、完全一致で評価されました。

### 実験結果

実験結果は下記の表に示されています。従来のテキストベースの手法（DirectとCoT）と比較して、ホワイトボード思考法（WoT）が大幅な性能向上を達成したことが明らかになりました。ASCII漢字認識タスクでは、ホワイトボード思考法が73.8%の [正解率](https://ai-data-base.com/archives/25930 "正解率") を達成し、他の手法（1.1%）を大きく上回りました。

![](https://ai-data-base.com/wp-content/uploads/2024/06/AIDB_71633_3.png)

ASCII単語認識タスクにおける各手法の正確性の内訳

![](https://ai-data-base.com/wp-content/uploads/2024/06/AIDB_71633_2.png)

BIG-Benchの3つのASCII理解タスクの例とホワイトボード思考法（WoT）による視覚化

BIG-Bench ASCII単語認識タスクで使用されている5つの異なるASCII形式（3D、Basic、Bubble、Doh、Dot Matrix）の結果も示されています。下記はそれらに対するホワイトボード思考法（WoT）の視覚化を示しています。

![](https://ai-data-base.com/wp-content/uploads/2024/06/AIDB_71633_4.png)

5つの形式それぞれに対する各手法の正確性は下の表のとおりで、テキストベースのアプローチ（DirectとCoT）は、’Bubble’と’Doh’カテゴリでのみ成功しています。’Bubble’と’Doh’は視覚的な解釈をあまり必要としないのが理由だと考えられます。一方、ホワイトボード思考法は’Bubble’以外のすべてのカテゴリで大幅に高い性能を示しています。

![](https://ai-data-base.com/wp-content/uploads/2024/06/AIDB_71633_5.png)

‘Bubble’形式は基本的に通常の文字に追加の文字（主にドットや線）を付け加えただけのものです。つまり、元の単語がほぼそのまま読み取れる状態です。ホワイトボード思考法は視覚化のステップを追加することで、単純なテキスト読み取りタスクを不必要に複雑化しているのかもしれません。’Bubble’のような単純なケースでは、視覚化のステップを追加することがかえって問題を複雑にし、エラーの原因となる可能性があります。

つまりすべてのケースでホワイトボード思考法が最適というわけではなく、タスクの性質に応じて適切な手法を選択することの重要性が示唆された結果です。

### エラー分析

下の図は、ASCII MNISTタスクにおけるホワイトボード思考法のエラーの原因を定性的に分析した結果を示しています。

![](https://ai-data-base.com/wp-content/uploads/2024/06/AIDB_71633_6.png)

エラーは以下の3つのカテゴリに分類されました。

1. コード実行エラー（4%）：視覚化スクリプトがエラーを起こし、画像が生成されなかった
2. 不適切な視覚化（21%）：生成された画像から正しい答えを導き出すのが困難
3. 視覚的認識エラー（75%）：生成された画像は適切だが、MLLMがそれを正しく解釈できなかった

ホワイトボード思考法のエラーの大部分は視覚的認識の段階で発生していることが分かります。言い換えると、マルチモーダルLLMの視覚理解能力がさらに向上すれば、ホワイトボード思考法の性能も大幅に改善される可能性があることを示唆しています。

### 空間ナビゲーション

次に実験された空間ナビゲーションタスクは、自然言語で記述された空間的な指示を理解し、その結果を推論する能力を評価するものです。人間がこのようなタスクに取り組むときは通常、心的イメージや物理的な地図を用いて解決するため、モデルの視覚的思考の能力を測るのに適しています。

### データセット

先行研究で作成された空間理解評価データセットが使用されました。以下の5つの空間構造に基づくナビゲーション問題が含まれています。

1. リング/円形
2. 六角形
3. 正方形
4. 菱形（45度回転した正方形）
5. 三角形

各空間構造について100例、合計500例が評価に用いられました。

### 視覚化の方法

Turtleライブラリが視覚化ツールとして採用されました。モデルには、ナビゲーション指示とともに、以下のような具体的な視覚化指示が与えられました。

- Pythonコードを使用してTurtleで各ステップを視覚化すること
- 方向の基準点として上を90度と設定すること
- ステップサイズを200に設定すること
- 最終位置を赤い点でマークすること（テキストで書かないこと）
- その他のステップはテキストで表示可能であること

### 実験結果

全体の結果を下の表に示しています。

![](https://ai-data-base.com/wp-content/uploads/2024/06/AIDB_71633_8-1024x256.png)

以下の点が明らかになりました。

**2次元グリッド構造（正方形と菱形）**

- テキストベースの手法（DirectとCoT）が高い性能を示しました。
- 正方形グリッドでCoTが98%の正解率と特に高いスコアを達成しました。

**非グリッド構造（円形、六角形、三角形）**

- テキストベースの手法の性能が大幅に低下しました。
- ホワイトボード思考法（WoT）が一貫して高い性能を維持しました。
- 六角形の場合、CoTの8%に対してホワイトボード思考法は61%の正解率と特に高いスコアを達成しました。

![](https://ai-data-base.com/wp-content/uploads/2024/06/AIDB_71633_7.png)

空間ナビゲーションのホワイトボード思考法視覚化の例

### 結果の考察

実験結果から、いくつかの興味深い洞察が得られます。

まず、テキストベースの手法が2次元グリッド構造で高い性能を示した理由として、この構造が座標系を用いてテキストで表現しやすいことが挙げられます。また、表形式データや都市のグリッド、2次元迷路問題など、インターネット上に豊富に存在するデータ形式と類似していることも一因と考えられます。

一方、ホワイトボード思考法は他のタイプの図形に対して高い性能を示しました。ホワイトボード思考法が2次元グリッド特有のテキスト知識に依存せず、より汎用的なアプローチであることを示唆しています。

さらに、人間の空間認知に関する興味深い点も浮かび上がります。人間の脳内にある格子細胞は六角形のグリッドで空間を表現すると言われているのですが、これは、LLMと人間の空間理解の違いを示す注目すべき点です。LLMが2次元グリッドで高い性能を示す一方、人間の脳内表現がより複雑な構造を持つという対比は、両者の認知プロセスの違いを浮き彫りにしています。今後の研究にも役立てる観点かもしれません。

## 実世界の応用例

ホワイトボード思考法の実世界における潜在的な使い道も探求されました。

### カリグラム理解

カリグラムとは、詩の視覚的配置が意味を補強する詩の形式です。

カリグラム理解のタスクでは、Guillaume Apollinaireの有名な詩が使用されました。単語の巧妙な配置によってエッフェル塔の形を描き出すという視覚的特徴を持っています。

![](https://ai-data-base.com/wp-content/uploads/2024/06/AIDB_71633_9.png)

ホワイトボード思考法が正しく詩の意味を特定する一方、CoTは誤った解釈をする例

従来の思考の連鎖（CoT）手法を用いた場合、モデルは詩の中に「舌」という単語が含まれていたことから、誤って「舌」や「吹き出し」の形を想像してしまいました。これは、テキストのみに基づく推論の限界を示しています。

一方、ホワイトボード思考法を適用した場合、モデルは視覚化のプロセスを通じて、正しくエッフェル塔の形を認識することができました。ホワイトボード思考法が詩の視覚的要素を正確に捉え、その意味を適切に解釈する能力を持っていることを明確に示しています。

このケーススタディは、視覚的な情報を含む複雑なテキスト理解タスクにおいて、ホワイトボード思考法が効果的であることを示唆しています。テキストと視覚の両方の側面を考慮することで、より深い理解と正確な解釈が可能になることが明らかになりました。

### ゲームアート

ゲームにおいても使い道があるかもしれません。例としてMinecraftでの子供の描画例を通じて、ホワイトボード思考法が適用されました。8×8のグリッド上に特定の順序で色付きのブロックが配置されるという状況が設定され、タスクの目的は、プレイヤーの行動ログから作成された絵を推測することでした。

![](https://ai-data-base.com/wp-content/uploads/2024/06/AIDB_71633_10-1024x465.png)

ホワイトボード思考法がゲーム（Minecraft）での行動をテキストから視覚化し解釈する例

ホワイトボード思考法を適用した結果、モデルは行動ログを視覚化することに成功し、その視覚情報を解析しました。その結果、描かれた絵がMinecraftの有名なキャラクターである「Creeper」の顔であることを正確に認識しました。ホワイトボード思考法はテキストベースの情報（行動ログ）を視覚的な表現に変換し、それを解釈する能力を持つことを示唆しています。

### その他、考えうる潜在的な応用分野

1. 詩や芸術作品の視覚的解釈  
	カリグラムの例が示すように、WoTは文学作品の視覚的要素を理解し、解釈することができます。つまり文学研究や芸術分析の分野で活用される可能性があります。
2. ゲーム開発  
	Minecraftの例のように、プレイヤーの行動ログから視覚的な結果を推測できます。そのため、不適切なコンテンツの検出や、プレイヤーの創造性の分析に役立つ可能性があります。
3. 視覚的な指示の理解と生成  
	空間ナビゲーションタスクの結果から、ホワイトボード思考法は複雑な視覚的指示を理解し、生成できることが示唆されています。さまざまなナビゲーションシステムや教育用ツールの開発に応用できるかもしれません。
4. データ視覚化の解釈  
	ホワイトボード思考法は、複雑なデータ視覚化の解釈や説明に活用できる可能性があります。ビジネスインテリジェンスや科学研究の分野で役立つかもしれません。

## まとめ

本記事では、マルチモーダルLLMに視覚的推論能力を付与する「ホワイトボード思考法」を紹介しました。仮想的な「ホワイトボード」を作成し、中間推論ステップを視覚化することで、視覚的および空間的推論タスクの性能を向上させる手法です。

実験ではASCII文字の理解や空間ナビゲーションなどのタスクで有効性が実証され、特に非グリッド構造の空間ナビゲーションで高い性能を示しました。カリグラムの理解やビデオゲーム内のプレイヤー行動の解釈など、実世界での応用例も提示されています。

今後、マルチモーダルLLMの能力向上に伴い、ホワイトボード思考法の性能もさらに向上すると期待されます。様々なアプリケーションへの応用が期待されます。

- 参照論文URL： [https://arxiv.org/abs/2406.14562](https://arxiv.org/abs/2406.14562)

**■サポートのお願い  
**AIDBを便利だと思っていただけた方に、任意の金額でサポートしていただけますと幸いです。  

  

[ロングコンテキストはRAGもText to SQLも解決するか　Googleがケーススタディを実施](https://ai-data-base.com/archives/71486)

[LLMにハイレベルな問題の解決アプローチを自分で考えさせるエージェント化手法「SelfGoal」](https://ai-data-base.com/archives/71720)

 [![](https://ai-data-base.com/wp-content/themes/innovate_hack_tcd025/img/footer/return_top.png) PAGE TOP](https://ai-data-base.com/archives/#header_top)