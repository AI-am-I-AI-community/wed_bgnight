---
title: "LLMによる時系列データ分析に「ニュース情報」を混ぜるアプローチ 為替予測精度など大幅に向上"
source: "https://ai-data-base.com/archives/79028"
author:
  - "[[AIDB Research]]"
published: 2024-11-22
created: 2025-06-13
description: "本記事では、時系列予測にLLMを活用した研究を紹介します。今回研究者らは、ニュース記事などのテキストデータを予測に組み込むことに成功しました。"
tags:
  - "clippings"
---
**【お知らせ】** AIDB主催のビジネスマッチングイベントを7月25日(金)開催予定です！  
  

\---以下、記事本文---

本記事では、時系列予測にLLMを活用した研究を紹介します。

今回研究者らは、ニュース記事などのテキストデータを予測に組み込むことに成功しました。

金融、エネルギー、パンデミック予測など幅広い分野での活用が期待される本手法は、予測精度の向上だけでなく、人間の行動や社会の変化をより正確に反映できる可能性を示しています。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79028-1024x576.jpg)

**参照論文情報**

- タイトル：From News to Forecast: Integrating Event Analysis in LLM-Based Time Series Forecasting with Reflection
- 著者：Xinlei Wang, Maike Feng, Jing Qiu, Jinjin Gu, Junhua Zhao
- 所属：The University of Sydney, The Chinese University of Hong Kong, Shenzhen, Shenzhen Institute of Artificial Intelligence and Robotics for Society

## 背景

時系列予測は、経済、インフラ、社会の様々な分野における意思決定の重要な基盤とされてきました。しかし従来の予測手法は、時系列の変動が安定している場合には有効でしたが、突発的な出来事による急激な変動や異常値への対応には限界があります。また、複雑な社会的出来事と時系列データの変動との関連性を体系的に理解することも難しい課題です。

そんな中、「ニュースデータ」が予測の精度向上における可能性を秘めています。ニュースには、予期せぬ出来事、政策変更、技術の進歩、世論の変化など、数値データだけでは把握できない重要な情報が含まれています。であれば、ニュースを予測に取り入れることで、人間の行動や社会の変化をより正確に反映できると考えられます。

これまでも、金融、エネルギー、エンターテインメント、パンデミック、観光など、様々な分野でニュースなどのテキスト情報を時系列予測に活用する試みがなされてきました。しかしキーワードの出現回数を数えたり、単純な変数として扱ったりするなど、テキストの分析が表面的なものにとどまっていました。

ここでLLMが役立つときです。LLMは事前学習によって幅広い知識と推論能力を身につけており、時系列の処理や予測にも応用され始めています。

LLMを時系列分析に使う研究はいくつかありますが、主に数値の予測に使用するにとどまり、テキストデータの理解や活用という観点からの検討は十分になされていませんでした。

こうした背景から、今回研究者らは、テキストと時系列データの両方を考慮した新しい予測手法の開発に取り組むことにしました。

## 手法

時系列予測にニュース情報を組み込むシステムの開発には、いくつか重要な課題があります。

1. まず、予測手法そのものに関する課題として、数値データではないニュースを柔軟に扱い、その文脈に基づいて予測を調整できる必要があります。
2. また、文章のような非構造化データを適切に処理できる仕組みも求められます。
3. 次に、モデル構築に関する課題があります。ニュースをフィルタリングし、時系列データとの関連性を見出す必要がありますが、これはインターネット上の膨大なデータから関連情報を見つけ出すという困難な作業を伴います。

上記の作業には社会の仕組みを深く理解し、高度な推論能力が必要となります。そのため、複雑な作業を遂行できるエージェントが必要です。

さらに、精度向上に関する課題もあります。ニュース選択の誤りや推論の誤りが予測精度に影響を与える可能性があるため、予測結果に基づいてニュース選択や推論を継続的に改善していく仕組みが必要となります。

このような課題に対応するため、本研究では3つの主要なモジュールが提案されます。

1つ目は言語モデルベースの予測モジュール  
2つ目はニュースのフィルタリングと推論を行うための推論エージェント  
3つ目は予測モデルを評価・改善するための評価エージェント

図は、これら3つのモジュールの関係性と全体のワークフローを示しています。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79028_1-1024x695.png)

時系列予測へのテキスト情報の統合の全体像。(A)情報検索、(B)推論エージェント、(C&D)LLMの微調整、(E)評価エージェントの各プロセスを図示。

### 時系列予測問題の新しい捉え方

時系列予測は、純粋に数値の予測問題として捉えられてきました。しかし、本研究では、これを「文脈を考慮した系列生成」という新しい視点で捉え直します。この考え方は、大規模言語モデルが得意とする処理方法と親和性が高いものです。

例えば、LLaMaのような言語モデルは、数値データを扱う際、それを個々の数字の並びとして認識します。「123」という数字が与えられた時、これを「1」「2」「3」という個別の要素の連なりとして理解し、次に来るべき数字を予測します。この予測の仕方は、私たちが文章を読んで次の単語を予測する過程に似ています。

一方でニュースの重要性は、数値だけでは見えてこない社会の変化を捉えられる点にあります。たとえば、突然の災害や政策変更といった予期せぬ出来事は、時系列データに大きな変化をもたらすことがあります。実際に私たちが観測する時系列データには、すでにこうした出来事の影響が含まれています。

しかし、出来事に関する情報がない状態で予測を行う場合、過去の数値の変化だけを頼りに将来を予測することになります。この場合、数値の変化は見えても、なぜその変化が起きたのかという理由は理解できません。ニュースは、こうした「なぜ」という部分を補完する重要な役割を果たします。

言語モデルでは、ニュースの内容も時系列データと同じように処理することができます。そのため「この出来事があったから、この数値変化が起きた」という因果関係を学習し、より正確な予測を行うことが可能です。図に示すように、実際の時系列データとニュースの間には、明確な関連性が見られます。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79028_2-1024x427.png)

ニュースと時系列データの関係性を示す図。豪州の州レベルの電力需要を例に、短期的影響のニュースと長期的影響のニュースの選別例を表示。

#### 補助的な情報の活用

時系列予測には、ニュースだけでなく、様々な「補助的な情報」も重要な役割を果たします。例えば気象や気候要因はエネルギー需要や産業生産に影響を与えます。また、金融指標や経済指標は消費者行動や企業活動に影響を及ぼします。このように多様な情報を取り入れることで、環境的、経済的、季節的な変動を考慮した予測が可能になります。

今回、こうした情報も言語の形式で表現し、柔軟に言語モデルと統合できるようにされました。例えば、気象条件は「過去の気象データ：最低気温は292.01度、最高気温は298.07度、湿度は94%でした」というテキストとして表現されます。

#### 言語モデルの調整

事前学習済みの言語モデルは、ある程度の時系列予測能力を持っていますが、まだ課題があります。

第一に、時系列の出力を制御すること。長い数値列を予測することは普通のタスクではないためです。  
第二に、ニュースや補助情報と時系列の関係性は、通常、過去のデータから導き出す必要があります。

そこで、ニュースや補助情報の条件を考慮しながら、より効果的に時系列を予測できるよう、言語モデルを調整する必要があります。教師あり学習の手法を用いて、過去の時系列データとそれに対応するニュース、補助情報をペアにして学習を行います。データはテキスト形式の入出力ペアで、以下は例です。

```js
入力:
- 履歴データ: オーストラリアの州別電力需要（半時間ごと）
- ニュースデータ: 各州での交通、気象、政策関連のニュース
 
タスク: ニュースデータを、対応する期間と地域の履歴データに一致させる。
出力: マッチングされたニュースと履歴データのペア
```

なお、モデルの調整には、LoRA（Low-Rank Adaptation）という手法を用います。パラメータの一部だけを更新することで、計算量を抑えながら、事前学習で得た知識の大部分を保持する手法です。

### ニュース情報の分析と推論のためのエージェントシステム

次に、上記のモデルを訓練するためのデータセット構築について。

時系列データの取得は比較的容易ですが、それに適切なニュースや補助情報を対応付けることは簡単ではありません。インターネット上には膨大なニュースが存在しますが、その大部分は予測対象の時系列とは無関係です。関係のないニュースを入れると予測を乱す可能性があるため、時系列予測タスクとニュースの関連性や因果関係を適切に分析する必要があります。

そこで、ニュース内容のフィルタリングと推論にも言語モデルを活用します。

最も高度な言語モデルでも、すべての推論と判断を単一の生成プロセスで完了することはできません。そこで、複数の言語モデル生成を組み合わせて、ニュースフィルタリングの複雑な要件を満たすインテリジェントなエージェントを作成します。

#### 時系列とニュースの事前マッチング

データ準備の初期段階では、時系列データに合わせてニュースを取得します。その際、時間の頻度、期間、地理的領域を一致させることが重要です。

例えば、2019年から2021年のオーストラリアの州レベルの電力需要を理解するために、同時期のオーストラリアの各州のローカルニュースと、需要に直接的または間接的に影響を与える可能性のある国際ニュースを収集します。

このように、まず大まかな条件でデータを収集し、その後より詳細な分析を行うという段階的なアプローチを採用します。

#### ニュース選択のための推論エージェント

推論エージェントの実装には、GPT-4 Turboが基盤として採用されました。エージェントの具体的な動作は、以下の3段階の処理として設計されています。

（１）初期ロジックの確立

エージェントには、まず対象ドメイン（例：電力需要）における重要な影響要因が学習されます。例えば電力需要の場合、「天候の急激な変化は24時間以内の需要に影響を与える」「新しい工場の建設は長期的な需要増加をもたらす」といった基本的な因果関係が、プロンプトを通じて与えられます。影響要因は、影響の期間（短期・長期）と方向性（増加・減少）で分類されます

このステップを実行するためのプロンプトは以下のようなものです。

```js
入力: {ニュースデータ}と{時系列予測タスク}
タスク:
1. ニュース選定ロジックを要約する。
2. 指定されたフォーマット（例: JSON）でロジックを提供する。
出力: {ニュース選定ロジックの要約とフォーマット済み結果}
```

（２）ニュースのフィルタリング処理

収集された各ニュース記事に対して、以下の判断基準が適用されます。

- 地理的関連性は予測対象地域との関係
- 時間的関連性は予測時点との近接性
- 影響の種類は直接的か間接的か
- 影響の強度はどの程度の変化をもたらすか

具体例として、「シドニーでの大規模停電」というニュースは、NSW州の電力需要予測において「直接的・短期的・強い影響」と判断されます。

（３）選択結果の構造化

選択されたニュースは、以下の要素を含むJSON形式で出力されます。

- ニュースの要約
- 発生地域と時間
- 予測への影響についての論理的説明
- 影響の分類（短期/長期）

なお、エージェントの具体的な入出力として、例えば以下のようなプロンプトとレスポンスのやり取りが行われます。

```js
入力：「2019年6月10日のNSW州の電力需要予測のため、関連ニュースを選択せよ」
出力：{
  "short_term_effects": [{
    "news": "シドニーで記録的な熱波、気温40度超え",
    "region": "NSW",
    "time": "2019-06-09 15:00:00",
    "rationality": "猛暑により冷房需要の急激な増加が予測される"
  }],
  "long_term_effects": [...]
}
```

各ステップでの判断基準と出力形式を明確に定義することで、一貫性のある予測関連ニュースの選択が実現されていることがわかります。

ニュースの分析とフィルタリングに使用されるプロンプトをテンプレートで表現すると以下のようになります。

```js
入力: {すべてのニュースデータ}
タスク:
1. 時系列予測タスクに関連するニュースを分類する。
2. 長期的または短期的な影響を持つニュースを識別する。
出力: {分類されたニュースのリストとその影響に関する要約}
```

#### 推論の更新のための評価エージェント

時系列予測の結果を分析し、ニュース選択の質を向上させるために評価エージェントが開発されました。

評価エージェントは、モデルが外れた予測をした日に、見落とされているニュースがなかったを確認します。例えば、「予測値が実際の電力需要より20%低かった6月10日について、選択されなかったニュースを検索し、因果関係を分析する」といった処理が行われます。

例えば評価プロセスは以下のようになります。

```js
入力データ：
- 予測日：2021-01-10
- 予測誤差：実測値が予測を15%上回った
- 選択済みニュース：[当日分と前日までの関連ニュース]
- 全ニュースプール：[その期間の収集済み全ニュース]
 
エージェントの分析手順：
1. 予測誤差の大きさと傾向を確認
2. その日の全ニュースを再検討
3. 見落としがあれば、なぜそのニュースが重要だったかを説明
4. 選択ロジックの改善点を提案
 
出力例：
「見落としニュース：ブリスベンで緊急都市封鎖が発表
理由：コロナ対策による急な都市封鎖は、商業施設の稼働停止を通じて電力需要の急減をもたらす可能性があった」
```

見落としが発見された場合、「感染症対策による都市封鎖は、発表後24時間以内の電力需要に影響を与える」「影響度の判定基準に『緊急性』の項目を追加する」といった具体的な改善が提案されます。

見落としたニュースがあるかどうかを確認するためのテンプレートは以下のようになります。

```js
入力: 予測結果、実際の値、使用されたニュース
タスク: ニュースが予測に適切に利用されたかを評価し、見逃したニュースを特定。
出力: 見逃したニュースとその影響についての記述。
```

また、選択ロジックを反復的に改良し、最適なロジックを構築するためのプロンプトは以下のようになります。

```js
入力: 現在のロジック、評価結果
タスク: 既存のロジックを改善し、新しい予測ロジックを生成。
出力: 改良されたロジックの要約。
```

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79028_3-1024x486.png)

各イテレーションにおけるプロンプト設計の例。Step 1:デフォルトロジックによるニュース選択、Step 2:検証セットによるロジック改善、Step 3:次イテレーションのデータペアリング。

### 全体のパイプライン

ニュースの推論エージェントと評価エージェントを時系列予測用の言語モデルの調整プロセスと統合することで、訓練データの質を向上させます。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79028_4-1024x429.png)

図に示すように、プロセスは以下のように進行します。

1. 最初の段階では、推論エージェントが、時系列タスクの領域と時間設定に基づいてニュース選択のロジックを確立します。
2. ロジックに従って、推論エージェントは関連性の高いニュースをフィルタリングし、時系列データと対応付けて、モデルの初期調整のための入力とします。
3. 次に、各イテレーション（繰り返し処理）で訓練データからランダムに抽出された検証セットを使用して評価エージェントがモデルの予測を評価します。
4. 評価エージェントは予測に影響を与えた可能性のある見落としニュースがないかチェックします。フィードバックは、次のイテレーションでのフィルタリングロジックの改善に活用されます。

※イテレーション＝反復

このサイクルは最終イテレーションまで継続され、その時点で推論エージェントはすべての更新を統合して、最終モデルの訓練に使用する決定的なニュースフィルターを作成します。

## 実験

### データの準備

人間の活動や社会的出来事の影響を受けるドメインが実験データとして選ばれました。Traffic（交通量）、Exchange（為替レート）、Bitcoin（ビットコイン価格）、そしてElectricity（オーストラリアの電力需要）です。なお事前知識のバイアスを避けるため、ExchangeとElectricityのデータセットは2022年まで更新されました。

電力需要データは、オーストラリアエネルギー市場運営者（AEMO）から30分ごとのデータが取得されました。また、為替レートデータはExchange Rates APIから日次データが収集されました。各データセットは、日次、時間単位、30分単位など、異なる時間解像度を持っています。

#### ニュースの収集

時系列データとニュースイベントを組み合わせた公開データセットが存在しないため、上記の時系列に対応する特定のニュースが収集されました。

ニュースコンテンツの一部は、 [GDELTデータセット](https://www.gdeltproject.org/) から取得されています。GDELTは、世界中のほぼすべての国から、100以上の言語で書かれたニュースを追跡するデータベースとして知られています。社会、政治、経済イベントに関するリアルタイムの洞察を提供しています。

なお最新の情報が必要なドメインについては、News Corp Australia（news.com.au）やYahoo Finance（yahoo.com）などのソースから、地域固有およびタスク固有の活動に関するリアルタイムのニュースが収集されました。

#### 補助的な情報の利用

より正確な予測と文脈理解のために、オープンソースツールを活用して追加データが収集されました。

OpenWeatherMapからの気象情報（日々の気温、大気圧、風速、湿度など）は、負荷予測において重要な役割を果たします。

また、Pythonのdatetimeとholidaysパッケージを使用して取得された暦情報は、季節性や周期性の影響を考慮するために用いられています。

経済指標は、pandas\_datareaderライブラリを通じて、連邦準備制度、世界銀行、国際金融市場などのソースからGDP、インフレ率、雇用統計といったデータが統合されました。

### 実験結果

まず、ニュースや補助情報を時系列予測に組み込むことの効果が検証されました。

以下の4つのシナリオで実験が実施されました。

1. ニュースを含まない、数値データのみを使用
2. 数値に加えて文章形式の説明を使用（ニュースなし）
3. 説明文に加えて、未フィルタリングのニュースを使用
4. 説明文に加えて、エージェントによって選別されたニュースを使用

実験結果は以下の通りです。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79028_5-1024x296.png)

以下の重要な知見が得られました。

まずデジタルトークンのみを使用した場合でも、調整された言語モデルは時系列予測に有効でした。次に適切なニュースと補助情報を導入することで、すべての4つのドメインで予測性能が大幅に向上しました。

ただし、このような改善は単純には達成できません。選別されていないニュース情報を大量に導入すると、逆に結果が大きく悪化することが示されました。

#### 評価エージェントの効果

評価エージェントを導入することで、予測の反復的な改善が可能になりました。結果を表に示します。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79028_t2-1024x296.png)

エージェントによるニュースフィルタリングの改善は、時系列予測の結果に段階的な向上をもたらしました。多くの場合、2回の反復で大幅な改善が達成され、複数回の反復は一回のみの場合と比べて常に良好な結果を示しました。

### 他の予測手法との比較

既存の時系列予測技術との比較も実施されました（表）。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79028_t3-1024x284.png)

本手法は、電力需要、為替レート、ビットコイン市場など、ニュースが大きな影響を持つ分野で、従来の手法を大きく上回る性能を示しました。

しかし、交通量予測における改善は比較的控えめでした。カリフォルニア全土の道路を対象とした交通量予測モデルは、公開されているニュースデータの粒度が粗すぎるため、正確な予測に必要な局所的な詳細情報が不足していました。交通データは特定の道路の交通流を反映しているのに対し、使用したニュースソースはほとんどが地域または全国レベルであり、局所的な交通状況を適切に捉えられないことが原因とされています。

下の図は、電力分野を例として、ニュースデータの有無による予測結果の比較を示しています。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79028_5-1-1024x222.png)

ニュースを含むモデルの予測は、突発的なイベントが電力需要に大きな影響を与える重要なタイミングで、実際の値により近い結果を示しました。

## まとめ

本記事では、LLMおよびLLMエージェントを活用して時系列予測の精度向上を試みた研究を紹介しました。

今回研究者らは、ニュース記事などのテキストデータを予測モデルに組み込む新しいアプローチを提案しています。実験では、電力需要、為替レート、ビットコイン価格、交通量の予測において、従来手法と比較して良好な結果が示されました。

ただし、この手法にも制限があります。人間活動や市場動向の影響を受けやすい分野では効果的である一方、気象データなど物理的な予測が必要な分野での有効性は限定的です。また、LLMのトークン長の制限により、大量の時系列データや複数のシーケンスを同時に処理することは難しいとされています。

今後は、ニュース内容の帰属分析やリアルタイムでの分析技術の向上など、さらなる研究の発展が期待されます。

- 参照論文URL： [https://arxiv.org/abs/2409.17515](https://arxiv.org/abs/2409.17515)
- データ： [https://github.com/ameliawong1996/From\_News\_to\_Forecast](https://github.com/ameliawong1996/From_News_to_Forecast)

**■サポートのお願い  
**AIDBを便利だと思っていただけた方に、任意の金額でサポートしていただけますと幸いです。  

  

[Claude 3.5 Computer Useのケーススタディ集　示唆される「GUIエージェントの夜明け」](https://ai-data-base.com/archives/78895)

[LLMによるバグ全自動修正に成功するケースと失敗するケースの違い](https://ai-data-base.com/archives/78378)

 [![](https://ai-data-base.com/wp-content/themes/innovate_hack_tcd025/img/footer/return_top.png) PAGE TOP](https://ai-data-base.com/archives/#header_top)