---
title: "LLMによるニュース報道の広がり分析を活用した株価変動予測手法"
source: "https://ai-data-base.com/archives/81516"
author:
  - "[[AIDB Research]]"
published: 2025-01-03
created: 2025-06-13
description: "本記事では、株式市場におけるニュースの影響力を分析し、株価変動を予測する新しい手法を紹介します。"
tags:
  - "clippings"
---
**【お知らせ】** AIDB主催のビジネスマッチングイベントを7月25日(金)開催予定です！  
  

\---以下、記事本文---

本記事では、株式市場におけるニュースの影響力を分析し、株価変動を予測する新しい手法を紹介します。

株価予測において市場参加者の感情（センチメント）を理解することは重要な要素とされており、LLMの登場によってその分析能力は飛躍的に向上しています。

研究者らは従来の手法では見落とされていた”ニュースの普及度合い”に着目し、株価予測の精度向上に取り組みました。

![](https://ai-data-base.com/wp-content/uploads/2025/01/AIDB_81516-1024x576.jpg)

**発表者情報**

- 研究者：Yixuan Liang et al.
- 研究機関：AI4Finance Foundation、ニューヨーク大学

**金融情報予測に役立つデータ分析の関連研究**

- [LLMによる時系列データ分析に「ニュース情報」を混ぜるアプローチ　為替予測精度など大幅に向上](https://ai-data-base.com/archives/79028)
- [時系列データの異常検知にLLMを使用する手法と実行プロンプト](https://ai-data-base.com/archives/69867)
- [時系列分析におけるLLMの可能性](https://ai-data-base.com/archives/67378)

## 背景

株式市場は世論やニュースに敏感に反応し、取引行動を通じて株価が変動することが知られています。市場参加者の感情（センチメント）の変化を理解することは価格変動パターンの重要な手がかりとなるため、現代の金融予測においてセンチメント分析は不可欠な要素となっています。

[自然言語処理](https://ai-data-base.com/archives/26319 "自然言語処理（NLP）") 技術の発展により、大量のテキストデータからセンチメントを分析・解釈する能力は飛躍的に向上しました。しかし従来の研究では個々のニュース記事のセンチメント分析の精度向上に重点が置かれ、市場全体のセンチメントの評価や株価予測への応用は限定的でした。

そんな中、LLMの登場は金融センチメント分析に転機をもたらしました。従来のセンチメントの分類に加えて、株価変動の予測根拠も提供できるようになりました。実際にFinRobotなどの研究では、マーケット予測ツールを通じて単一のニュース分析を超えた包括的なセンチメント分析が実証されています。

しかし既存手法の多くはニュースの内容のみに依存しており、市場の反応や株価変動に大きな影響を与えるニュースの普及（どれだけ広く報道されているか）という重要な要素が考慮されていませんでした。また、十分なコンテキストデータ（企業の財務状況や市場環境などの背景情報）が不足しているため、LLMのニュース解釈能力が制限されるという課題もありました。

そこで今回研究者らは、毎週の株価変動を予測するため、ニュースの普及範囲やコンテキストデータ、正確な指示を組み込んだ新しいアプローチの開発に取り組みました。株価の変動は上昇・下降それぞれ6段階（1%未満から5%以上まで）に分類され、予測には「前週の株価動向」、「最新のニュース」、「企業の基礎的な財務指標」が活用されます。

以下で詳しく紹介します。

![](https://ai-data-base.com/wp-content/uploads/2024/12/AIDB_81516_1-edited.png)

フレームワークの全体像

## データ処理と予測モデルの設計

本研究で考案された株価予測システムは、データの収集と処理、予測モデルの作成という大きく2つの工程で構成されています。まずデータ処理の全体像を確認し、その後で各工程の詳細を見ていきましょう。

### データの収集と前処理

株価データとニュース記事という2種類のデータを扱います。株価データはFinnhubというサービスのAPIを通じて取得します。APIとは、外部のサービスからデータを取得するための仕組みです。

週単位の株価変動（例：先週比3%上昇）に加えて、日々の終値とその変動率も記録します。株価データには企業の財務情報も含まれ、四半期報告書が公開されてから3週間後にデータセットへ反映されます。

### ニュースの整理と分類

人気企業の場合、1週間に200本以上のニュース記事が配信されることもあります。似たような内容の記事も多いため、効率的に処理するための工夫が必要です。

まず、Sentence [Transformer](https://ai-data-base.com/archives/26535 "Transformer") sという技術を使って、記事の内容を数値の並び（ベクトル）に変換します。文章を数値化することで、コンピュータによる類似度の計算が可能になります。

次に、BERTopicという手法で似た内容の記事をグループにまとめます。グループ内の記事がどれだけ似ているかを、コサイン類似度という指標で計算します。0から1の値を取り、1に近いほど記事の内容が似ていることを示します。

平均類似度が0.6を超えるグループは「高品質グループ」として扱い、そのグループを最もよく代表する記事を1つ選びます。グループの大きさ（記事数）と報道期間も記録されます。

### 予測モデルの作成手順

予測モデルの学習には以下のデータを使用します。

- 企業の基本情報
- 過去の株価の動き
- グループ化されたニュース（代表記事、グループの大きさ、報道期間）
- 財務指標
- モデルへの指示文（分析の観点や注意点）

モデルの学習には、NVIDIA A100という高性能な [GPU](https://ai-data-base.com/archives/26570 "GPU") を使用します。学習時の設定値として、学習率（1×10^-5）、重み減衰（0.01）、 [バッチサイズ](https://ai-data-base.com/archives/26582 "バッチサイズ") （32）、学習回数（5 [エポック](https://ai-data-base.com/archives/26594 "エポック") ）、最大文字数（8000トークン）などが指定されます。DeepSpeedという学習の効率化ツールを使用し、約2時間40分で学習が完了します。

予測は株価の変動幅に応じて12段階に分類されます。上昇と下降それぞれについて、0-1%、1-2%、2-3%、3-4%、4-5%、5%以上という6段階で評価されます。

実験を再現する際は、まずデータの収集と整理から始めることになります。各段階で得られる中間データを保存しておくと、問題が発生した際のデバッグが容易になります。

## 予測システムの性能評価

予測システムの性能は2つの観点から評価されます。株価の上昇・下降を正しく予測できたかという「予測精度」と、予測の判断根拠がどれだけ適切かという「分析の質」です。

予測精度の検証には、20社380件の株価データが使用されています。1つの企業に偏ることを避けるため、様々な業種の企業が選ばれています。

### 株価予測の精度向上

まず株価の実際の変動が記録され、予測が正しかったかどうかが1件ずつ確認されます。株価が上昇すると予測して実際に上昇した場合、または下降すると予測して実際に下降した場合が「正解」とカウントされます。正解数を総予測数で割ることで、予測精度が算出されます。

日次の株価データを導入した手法（HG）とニュースのグループ化を加えた手法（HG-NC）それぞれについて予測精度が計算され、従来手法との比較が行われます。

従来手法では55.0%だった予測精度が、日次株価データの活用で59.2%に、さらにニュースのグループ化を導入することで63.0%まで改善されています。

![](https://ai-data-base.com/wp-content/uploads/2024/12/AIDB_81516_2-1024x283.png)

従来と比べて大きな精度改善を示している

#### 予測精度向上の要因分析

予測精度の向上には、ニュースの影響を時間軸で区別できるようになったことが寄与しています。分析内容を詳しく調べたところ、「長期」への言及が15.0%から69.8%へ、「短期」への言及が7.5%から56.6%へと大幅に増加していました。長期的・短期的な影響を区別して分析できるようになったことで、より正確な予測が可能になったと考えられます。

### 分析の質的評価

分析の質はROUGEスコアと呼ばれる指標で評価されました。ROUGEスコアは生成された分析内容と理想的な分析内容の一致度を測定するもので、スコアが高いほど分析の質が高いことを示します。

#### ROUGE指標による評価

予測根拠の評価にはROUGEスコアという指標が使用されます。ROUGEスコアは、生成された分析と理想的な分析を文章単位で比較し、どれだけ内容が一致しているかを数値化したものです。

- ROUGE-1：単語単位での一致度
- ROUGE-2：2つの単語の組み合わせでの一致度
- ROUGE-L：文章の中で最も長く一致する部分の割合

例えば「株価は上昇傾向にあります」という文と「株価は上昇しています」という文を比較する場合、「株価」「上昇」という単語が共通して使われているため、ある程度の一致度があると判定されます。

ニュースのグループ化を導入した手法は、全ての指標において従来手法を上回る結果を示しています。市場の様々な要因間の複雑な関係性がより適切に分析されるようになったことが示唆されています。

![](https://ai-data-base.com/wp-content/uploads/2024/12/AIDB_81516_3-1024x292.png)

手法ごとのRougeスコア

### ボーイング社での事例研究

具体例としてボーイング社の株価予測が分析されました。日次株価データとニュースのグループ化を組み合わせた手法では、予測精度が63.2%に達し、日次株価データのみを用いた手法（52.63%）を上回りました。

#### ニュースグループ化の効果

ニュースのグループ化が予測精度に与える影響を詳しく調べるため、関連性の高いニュース記事（高凝集性クラスタ）の割合が分析されました。高凝集性クラスタの割合が50%を超えるケースで予測精度が向上する傾向が見られ、逆にその割合が40%を下回ると予測精度が低下することが明らかになりました。重要な市場情報の捕捉が予測精度に大きく影響することが示唆されています。

![](https://ai-data-base.com/wp-content/uploads/2024/12/AIDB_81516_4-1024x614.png)

評価結果を再現可能にする際には、まず少量のデータで手法の確認を行い、その後で評価規模を拡大することをお勧めします。

## まとめ

本記事では、ニュースの報道状況を組み込んだ株価予測手法の研究を紹介しました。

研究チームは、日次の株価データとニュースのグループ化を組み合わせ、従来手法を改善しました。

関連ニュースのまとまりが強い場合（全体の50%以上）に予測精度が向上する傾向が示され、ニュースの影響力を考慮することの重要性が浮き彫りとなりました。

**参照文献情報**

- タイトル：FinGPT: Enhancing Sentiment-Based Stock Movement Prediction with Dissemination-Aware and Context-Enriched LLMs
- URL： [https://arxiv.org/abs/2412.10823](https://arxiv.org/abs/2412.10823)
- 著者：Yixuan Liang, Yuncong Liu, Boyu Zhang, Christina Dan Wang, Hongyang Yang
- 所属：AI4Finance Foundation, New York University Shanghai

## 理解度クイズ（β版）

1\. この研究で株価予測の精度を向上させた主な革新点は何ですか？

ニュースの普及度（報道の広がり）と日次株価データを組み合わせた手法が開発された。従来見落とされていたニュースの普及範囲を考慮することで予測精度が向上した。

解説を見る

2\. ニュースのグループ化（クラスタリング）の目的は何ですか？

類似したニュースをグループ化することで、個々のニュースの市場への影響力を評価できる。特に週200件以上の記事がある人気銘柄で効果的。

解説を見る

3\. 研究で提案された手法の評価基準として重視されたのは？

株価の上昇・下降を予測する精度とROUGEスコアによる分析内容の質が評価された。予測精度と分析の質の両面から包括的な評価が行われた。

解説を見る

4\. ニュースの影響分析において、研究チームが重視した視点は？

ニュースが市場に与える影響を短期的なものと長期的なものに区別して分析する手法が導入された。ニュースの即時的な影響と持続的な影響を区別することで予測精度が向上した。

解説を見る

5\. この研究の予測モデルで最も高い予測精度を達成したのは、どのような条件下でしたか？

関連性の高いニュース記事の割合が50%を超えるケースで最も高い予測精度を示した。逆に関連記事が40%未満の場合は予測精度が低下することが確認された。

解説を見る

**■サポートのお願い  
**AIDBを便利だと思っていただけた方に、任意の金額でサポートしていただけますと幸いです。  

  

[スマートフォンで取れる日常のセンサーデータをLLMで分析し、生活を自然言語で記録する](https://ai-data-base.com/archives/81453)

[LLMは個人の金銭管理を適切にサポートできるのか？](https://ai-data-base.com/archives/81597)

 [![](https://ai-data-base.com/wp-content/themes/innovate_hack_tcd025/img/footer/return_top.png) PAGE TOP](https://ai-data-base.com/archives/#header_top)