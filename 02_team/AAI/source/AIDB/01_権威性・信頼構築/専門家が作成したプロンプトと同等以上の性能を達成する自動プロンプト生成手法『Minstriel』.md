---
title: "専門家が作成したプロンプトと同等以上の性能を達成する自動プロンプト生成手法『Minstriel』"
source: "https://ai-data-base.com/archives/76468"
author:
  - "[[AIDB Research]]"
published: 2024-10-02
created: 2025-06-13
description: "本記事では、構造的なプロンプトを設計するためのフレームワーク『LangGPT』とプロンプト生成ツール『Minstriel』を紹介します。"
tags:
  - "clippings"
---
**【お知らせ】** AIDB主催のビジネスマッチングイベントを7月25日(金)開催予定です！  
  

\---以下、記事本文---

本記事では、構造的なプロンプトを設計するためのフレームワーク『LangGPT』とプロンプト生成ツール『Minstriel』を紹介します。

研究者らは、これら2つを併せることによって、プログラミング言語の概念を取り入れた設計でプロンプト自動生成の実現を目指します。

本研究の狙いは、専門家ではない人でもLLMの能力を引き出せるようにすることです。実験では、様々なタスクでの有効性検証と、ユーザー調査による使いやすさの評価が行われています。

![](https://ai-data-base.com/wp-content/uploads/2024/10/AIDB_76468-1024x576.jpg)

**参照論文情報**

- タイトル：Minstrel: Structural Prompt Generation with Multi-Agents Coordination for Non-AI Experts
- 著者：Ming Wang, Yuanzhong Liu, Xiaoyu Liang, Yijie Huang, Daling Wang, Xiaocui Yang, Sijia Shen, Shi Feng, Xiaoming Zhang, Chaofeng Guan, Yifei Zhang
- 研究機関：Northeastern University, Wuhan University, Zhejiang University, Shenyang Aerospace University

## 背景

LLMの能力を最大限に活用するのは難しいことです。プロンプトエンジニアリングという概念が考案され、LLMとの効果的なコミュニケーションを通じて、望ましい出力を得るための手法が研究されてきました。

しかし、これまで考えられてきたプロンプト設計手法には課題がありました。プロンプトの書き方のコツがまとめられたり、自動最適化手法が開発されたりしましたが、コツや既存の自動化手法には体系がなく、さらに人間の学習コストが高いという問題があります。専門家ではない人にとっては特に難しいものです。

そこで今回研究者たちは、プログラミング言語からヒントを得て、新しいアプローチを考案しました。プログラミング言語は体系的で再利用可能であるといった特徴を持っています。この特徴を踏襲して、自然言語の柔軟性と組み合わせることで、使いやすくかつ効果的なプロンプト設計の枠組みを作り出そうとしたのです。

以下で今回開発された手法と実験結果を紹介します。

![](https://ai-data-base.com/wp-content/uploads/2024/10/AIDB_76468_3.jpg)

人がLLMを使用する際に不満を持つイメージ

## 構造化されたプロンプト設計フレームワーク「LangGPT」

研究者たちは、まずは非AI専門家でも使いやすいプロンプト設計フレームワークを作ろうとしました。そこで注目したのが、前述の通りプログラミング言語です。プログラミング言語は体系的で再利用性が高いという特徴があります。

しかし通常、ユーザーがLLMに送るプロンプトは自然言語です。  
自然言語とプログラミング言語の主な違いは以下の通りです。

- 自然言語は主にコミュニケーション用で、曖昧さがあり柔軟
- プログラミング言語は機械に指示を出すためのもので、標準化されており正確

研究者らは、自然言語とプログラミング言語の利点を組み合わせたフレームワークを作ることにしました。以下のような特徴を持つのが理想です。

1. 体系的な構造
2. 再利用可能
3. 拡張性が高い
4. 非AIの専門家でも習得しやすい

### 二層構造の採用

研究者らは、オブジェクト指向プログラミング言語の設計思想を参考にしました。その結果、「モジュール」と「要素」という二層構造が採用されました。

モジュールはプログラミング言語のクラスに似ており、LLMに対する要求の側面を表します。

そして要素はプログラミング言語の関数やプロパティに似ており、LLMへの直接的で具体的な指示の内容を表します。

それぞれ詳しく見ていきます。

### モジュール

以下のような基本モジュールが定義されました。

1. Role（役割）：プロンプトの名前であり、LLMに設定する役割
2. Profile（プロフィール）：プロンプトのバージョン管理や更新を容易にするための基本情報
3. Constraints（制約）：LLMが応答を生成する際に違反してはいけない禁止事項や必ず満たすべき要件
4. Goals（目標）：ユーザーが達成したい最終目的を列挙する
5. Initialization（初期化）：対話を開始することをLLMに伝える
6. Examples（例）：LLMが学習するための入出力ペアの例を提供する
7. Workflow（作業の流れ）：複雑なタスクの場合、LLMに実行プロセスを指示する
8. Skills（スキル）：タスクに関連するLLMの知識や能力を活性化する
9. Suggestion（提案）：分岐状況でLLMが取るべき行動や応答のアドバイスを提供する
10. Background（背景）：LLMがタスクを実行する際に必要な文脈情報や記憶を指定する
11. Style（スタイル）：LLMの応答のスタイル、トーン、感情的特徴を指定する
12. Output format（出力形式）：LLMの応答の形式を指定する
13. Command（コマンド）：LLMベースのアシスタントが単一のアクションに固執しないようにするためのモジュール

このうちのいくつかは、手作業でプロンプトを構築する際にも押さえておくべき重要なパーツになっていると考えられます。

![](https://ai-data-base.com/wp-content/uploads/2024/10/AIDB_76468_4-1024x444.png)

記事のタイトル生成シナリオにおける例

### 要素

一方の「要素」は、プロンプトの具体的な内容を構成するものです。研究者たちは、プロンプトの事例分析に基づいて、以下のように要素の設計を行いました。

まず、要素には主に3つの目的があります。

1. LLMに特定の情報を暗示する
2. LLMに特定のタスクを実行させる（出力の有無は問わない）
3. 上記2つの組み合わせ

そこで目的に基づいて、次のような基本的な要素の書き方が提案されています。

（１）情報の暗示

「⟨プロパティ⟩は⟨値⟩です。」というテンプレートを使用します。

（２）タスクの実行

「⟨プロパティ⟩が⟨値⟩である場合、以下のアクションを実行してください：⟨アクション⟩；⟨結果⟩を返してください。」というような形式を使用します。

ただし、上記は基本的なアイデアを示すものであり、実際の使用では状況に応じて言語を調整し、柔軟に表現することが推奨されています。

## マルチエージェントによる自動プロンプト生成「Minstrel」

LangGPTフレームワークを自動化するためにMinstrelという方法論が開発されました。複数のエージェントが協力して、構造化されたプロンプトを生成します。

プロンプトの最適化にはLLMが活用されることが多いですが、LLMを単純に使用しようとすると以下の作業が苦手であることがわかります。

1. タスクを完全に理解すること
2. プロセスを分解すること
3. 表現を最適化すること
4. ユーザーの要求を構造化されたプロンプトに変換すること

そこで、作業ごとにグループを作成するというアイデアが採用されることになりました。各グループ内のエージェントが、類似した原子的タスクを担当します。  
原子的タスクとは、もうそれ以上は分割を必要としないタスクを指します。

全体的なフレームワークは以下のような構成です。

1. 異なるモジュールに対応するエージェントが協力して構造化プロンプトを生成する
2. 議論を通じて、プロンプトを体系的にテストし、さらに最適化する

![](https://ai-data-base.com/wp-content/uploads/2024/10/AIDB_76468_5-1024x634.jpg)

マルチエージェント協調によるMinstrelの構造化プロンプト生成フレームワークの全体図

以下ではMinstrelの特徴を詳しく見ていきます。

### 作業グループ

Minstrelは、プロンプト設計を異なる作業グループに分割します。まるでソフトウェア開発会社の異なる部署のような働きをします。各グループは協力しながらも、それぞれ独自の役割を持っています。

主な作業グループは3つあります。

1. 分析グループ (A)：ユーザーの要求、フィードバック、テスト結果を分析する
2. 設計グループ (D)：異なるモジュールのプロンプト内容を生成する主な役割を担う
3. テストグループ (T)：生成された構造化プロンプトの体系的なテストを行う

### 作業グループ内のエージェント

各作業グループには、特定の役割を持つエージェントが含まれることになります。

**分析グループ (A)に必要なエージェント**

分析者 A(m)  
ユーザーのタスク要求を分析し、適切なモジュール設計エージェントを起動します。

反省者 A(r)  
テストフィードバックとユーザーフィードバックから問題をまとめ、対応するモジュール設計エージェントに反映させます。

**設計グループ (D)に必要なエージェント**

モジュール設計エージェント D(k)  
LangGPTの各モジュール (k) に対応するエージェントです。例えば、

- D(cons.)：制約モジュールの内容を生成する
- D(bkgd.)：背景モジュールの内容を生成する
- D(goal)：目標モジュールの内容を生成する
- D(work)：ワークフローモジュールの内容を生成する

それぞれ担当するモジュールのプロンプト内容を生成する役割を果たします。各モジュールに対して専門的なエージェントがあり、タスクに応じて適切なエージェントが起動されるといった仕組みです。

**テストグループ (T)に必要なエージェント**

シミュレーター T(s)  
生成されたプロンプトに従って助手として機能します。

質問者 T(q)  
シミュレーターと対話します。

コメンテーター T(c)  
シミュレーターのパフォーマンスにコメントし、互いに議論することもあります。

### 反省を伴う複数エージェントの協調

Minstrelの動作プロセスは、設計と反省の2つの段階に分かれています。

（１）設計段階

1. ユーザーがタスク t を提案すると、分析者 A(m) がそれを分析し、必要なモジュールを起動する
2. 起動されたモジュールに対応する設計グループのエージェントが、プロンプトの内容を生成する

（２）反省段階

1. テストグループがプロンプトをテストし、フィードバックを提供する
2. 反省者 A(r) がテストグループのコメントとユーザーのコメントを分析し、必要な修正を特定する
3. 分析者 A(m) が修正が必要なモジュールを再度起動し、内容を更新する

このプロセスが繰り返し行われ、最終的に構造化されたプロンプトが完成します。

ちなみに数式で表現することも可能とされており、

設計段階は Sa = Am(t), M\[k\] = D(k)(t) for k in Sa

反省段階は Ct = T(c)(T(s)(ΣM), T(q)(t)), Sr = A(r)(Ct + Cu), M\[k\] = M\[k\] + Am(Sr)

です。Sa はモジュールの起動状態、M はモジュールの内容リスト、Ct はテストグループのコメント、Cu はユーザーのコメント、Sr は反省に基づくモジュールの更新状態を表しています。

## 実験

手動で設計したLangGPTプロンプトとMinstrelが自動生成したプロンプトの効果が、従来の方法（ベースライン）と比較されました。

### 使用されたLLM

実験では、以下のLLMが使用されました。

1. Gemma-2-9b-it
2. Qwen2-7B-Instruct
3. Meta-Llama-3.1-8B-Instruct
4. Mistral-7B-Instruct-v0.2
5. GPT-4o-mini
6. Claude3-haiku

### 評価方法

プロンプトの品質を直接評価するのは難しいため、研究者たちはLLMのタスク遂行能力を通じて間接的に評価することにしました。以下のベンチマークが活用されました。

1. EQ-Bench：感情知能のベンチマーク
2. GPQA：専門知識のクイズ
3. GSM8k：数学の問題解決ベンチマーク
4. IFEval：指示に従う能力を評価するベンチマーク
5. TruthfulQA：虚偽検出能力ベンチマーク

### 主な結果と分析

まず前提として、LangGPTプロンプトは、ベースラインのプロンプトと比較して、LLMのタスク遂行能力を向上させました。

![](https://ai-data-base.com/wp-content/uploads/2024/10/AIDB_76468_8-1024x863.png)

異なるプロンプトで指示された言語モデルのパフォーマンス。LangGPTは手動で書かれたプロンプト、Minstrelは自動生成されたプロンプトを示す。

次にMinstrelが自動生成したプロンプトは、人間の専門家が書いたプロンプトに匹敵する、あるいはそれを上回る結果を達成しました。

そしてプロンプトの効果は、モデルやタスクによって異なることが観察されました。難しいGPQA（専門知識のクイズ）では、性能の低いモデルほど複雑なプロンプトの影響を受けやすい傾向がありました。

なお小規模なLLMでは、LangGPTプロンプトの効果が限定的であることが分かりました。中でも0.5Bの Qwenモデルでは、LangGPTプロンプトを使用しない場合よりも性能が低下しました。

![](https://ai-data-base.com/wp-content/uploads/2024/10/AIDB_76468_6-1024x523.jpg)

異なるスケールのQwenモデルにおける各タスクの結果。LangGPTプロンプトの使用有無による比較

### 使いやすさの評価

研究者たちは、LangGPTとMinstrelの使いやすさを評価するために、オンラインコミュニティでユーザーアンケートを実施しました。

その結果、89.66%のユーザーがLangGPTの使いやすさを3点以上（5点満点）で評価しました。

また、LangGPTの総合満足度は10点満点中8.55点でした。

なお事前のプロンプトエンジニアリングのトレーニングを受けていない一般ユーザーでも、LLMの性能を向上させる優れたプロンプトを書くことができました。

### ケーススタディ

研究者たちは、構造化プロンプトの効果をより直感的に示すために、コミュニティからいくつかの具体的な事例を選びました。

例えば、LLMにおべっか使いの役割を演じさせる実験では、LangGPTプロンプトを使用したChatGPTの方が、より多角的で詳細な褒め言葉を生成できることが示されました。

![](https://ai-data-base.com/wp-content/uploads/2024/10/AIDB_76468_7-769x1024.jpg)

お世辞を言う例。3つの異なるプロンプトに対するChatGPT-3.5の応答を示している

## まとめ

本記事では、LangGPTという構造化プロンプト設計フレームワークとMinstrielというプロンプト生成ツールの研究を紹介しました。

この2つを活用したプロンプトは、LLMの性能を向上させることが示されました。

ただし、低性能モデルへの適応には課題が残されています。研究チームは今後、この点の改善を目指すとしています。

- 参照論文URL： [https://arxiv.org/abs/2409.13449](https://arxiv.org/abs/2409.13449)
- プロジェクトページ： [https://langgpt.ai/](https://langgpt.ai/)

**■サポートのお願い  
**AIDBを便利だと思っていただけた方に、任意の金額でサポートしていただけますと幸いです。  

  

[米国3人に1人が生成AIを使用　ブルーカラー労働者も生産性向上　大規模調査より](https://ai-data-base.com/archives/76405)　

[対話の中でユーザーの好みを学ぶ手法『CIPHER』　（プロンプトテンプレートあり）](https://ai-data-base.com/archives/76527)

 [![](https://ai-data-base.com/wp-content/themes/innovate_hack_tcd025/img/footer/return_top.png) PAGE TOP](https://ai-data-base.com/archives/#header_top)