---
title: "時系列データをグラフにしてLLMに見せると文字だけより最大120%性能向上 トークンも節約"
source: "https://ai-data-base.com/archives/79686"
author:
  - "[[AIDB Research]]"
published: 2024-12-03
created: 2025-06-13
description: "本記事では、時系列データをLLMで分析する手法の調査研究を紹介します。現在、世の中にある大量の時系列データは活用しきれていないという課題があり、さまざまな研究者らが効率的な分析手法を模索しています。"
tags:
  - "clippings"
---
**【お知らせ】** AIDB主催のビジネスマッチングイベントを7月25日(金)開催予定です！  
  

\---以下、記事本文---

本記事では、時系列データをLLMで分析する手法の調査研究を紹介します。

現在、世の中にある大量の時系列データは活用しきれていないという課題があり、さまざまな研究者らが効率的な分析手法を模索しています。

これまでに考えられてきたLLMベースの手法は追加学習や専門知識が必要でしたが、今回、モデルの視覚を利用するというシンプルなアプローチの効果が確認されています。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79686-1024x576.jpg)

**参照論文情報**

- タイトル：Plots Unlock Time-Series Understanding in Multimodal Models
- 著者：Mayank Daswani, Mathias M.J. Bellaiche, Marc Wilson, Desislav Ivanov, Mikhail Papkov, Eva Schnider, Jing Tang, Kay Lamerigts, Gabriela Botea, Michael A. Sanchez, Yojan Patel, Shruthi Prabhakara, Shravya Shetty, Umesh Telang
- 所属：Google

**「時系列データ分析」の関連研究**

- [LLMによる時系列データ分析に「ニュース情報」を混ぜるアプローチ　為替予測精度など大幅に向上](https://ai-data-base.com/archives/79028)
- [時系列データの異常検知にLLMを使用する手法と実行プロンプト](https://ai-data-base.com/archives/69867)
- [時系列分析におけるLLMの可能性](https://ai-data-base.com/archives/67378)

## 背景

LLMはマルチモーダル化が進み、テキスト以外のデータも扱えるようになったものの、時系列データの分析にはまだ十分に活用されていない状況にあります。時系列データは、例えばヘルスケアや金融、社会科学分野において大量に存在する多次元のデータです。

以前より、LLMで時系列データを扱うためのいくつかのアプローチが提案されてきました。その中でテキストのみのLLMでも予測タスクで良好な性能を示すことは実証されてきました。しかし、以下のような課題も認識されてきたのです。

1. 追加のデータ、計算リソース、専門知識が必要
2. 既存のアプローチは特定のタスク向けに最適化されており、汎用性に欠ける

ここで、実はLLMのデータ処理プロセスは人間のアプローチに似ていることが次の解決策へのヒントになりました。LLMもまた、可視化された情報を確認し、その後で統計分析を行うことで洞察を得るというプロセスを取るのが一般的のようです。

このような背景から、Googleの研究チームによって、マルチモーダルLLMで時系列データをプロットとして「見る」というシンプルかつ効果的な手法が提案されるに至りました。追加のモデル訓練を必要とせずに時系列データの分析がスムーズに実行できる可能性を秘めています。

どのようなタスクで検証され、どれほどの成果が得られたのか、以下で紹介していきます。

## 研究の進め方

時系列データをLLMに理解させる新しい方法として「数値の羅列が提示されるのではなく、グラフとして視覚化されるアプローチ」が本当に効果的かどうかを検証するため、2段階の実験が行われました。

### 第1段階：基礎実験

まず、人工的に作られた（合成）データを用いて基礎実験が実施されました。合成データを使用する利点としては、実験条件が自由に調整可能であることが挙げられます。

例えば、以下のような調整ができます。

- ノイズ（乱れ）をデータに加えて、難易度を変える
- データの量を増減させる
- 複数のデータを組み合わせて、複雑な状況を作り出す

このように条件を細かく制御することの意義は、手法の性能をより正確に評価できる点にあります。

### 第2段階：実用実験

次に、実際の現場で収集されたデータを用いた実用実験が行われました。以下のようなデータが使用されました。

- スマートフォンのセンサーデータ
- ウェアラブル端末の計測データ
- 健康管理に関するデータ

現場のデータは合成データよりも複雑で、ノイズを含んでいますが、まさに現実の課題を反映したものになります。

なお、個人情報を含むデータについては、プライバシー保護の観点から別の環境で処理が行われました。

### 実験で使用されたツール

実験には、オープンソースの「 [Langfun](https://github.com/google/langfun) 」というツールが使用されました。以下のような良い点があるツールです。

- 実験の再現性が高められる
- 結果の信頼性が向上する
- 他の研究者による追試が容易になる

### モデルの選択

実験には以下4種類のLLMが使用されました。

- Gemini Pro 1.5
- GPT4o
- Gemini Flash 1.5
- GPT4o-mini

上2つは高性能モデルとしての位置づけで、下2つは比較のために選ばれた小規模モデルです。

### データの数値表現の工夫

時系列データを扱う際、数値の表現方法も重要です。今回その点（表現方法）も検討された結果、以下のことが明らかになりました。

- 小数点以下の桁数は少ない方が適切である
- 数値の区切り方にはモデルごとの好みがある
- 実用的な場面では、最もシンプルな表現が効果的である

なお、この発見は先行研究「 [LLMTime](https://arxiv.org/abs/2310.07820) 」の知見とも一致していました。

### 結果の分析方法

実験結果は、統計的手法を用いて慎重に分析されました。

例えば正確さを示す指標が使用され、結果のばらつきが考慮されました。また、信頼区間が計算されました。

実世界のデータについては、同じ条件での再実験が難しいため、ブートストラップ法（手元のデータを繰り返し再 [サンプリング](https://ai-data-base.com/archives/26518 "サンプリング") して統計的性質を推定する方法）が用いられ、高い信頼性を持つ評価が行われました。

## 実験と結果

下2つの表には今回行われた合計8つの実験タスクのサマリーが記されています。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79686_1-1024x410.png)

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79686_2.png)

以下で、それぞれの実験の詳細と得られた知見について説明します。

### 合成データを用いた実験

合成データを用いた実験は5種類行われました。

下の図にそれぞれのゼロショット（例を示さずに解かせる方法）の結果が示されています。GPTおよびGeminiモデルファミリーの両方で、プロットベースの手法がテキストベースの手法を上回る結果が得られています。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79686_3-edited.png)

なお、それぞれのタスクの詳細は以下の通りです。

#### （１）関数形状の識別

最も基本的なタスクです。単一のトレンドを識別し、5つの関数クラス（線形、二次、三次、指数、周期）のいずれかに正しく分類することが求められました。

#### （２）2本の線の相関関係

2つのトレンドを理解し、それらを比較して正の相関か負の相関かを判断する能力が評価されました。

#### （３）2次元クラスター数のカウント

点群の中からN個のクラスターを正しく識別してカウントする能力が試されました。

#### （４）導関数の識別

比較的高度なタスクです。4つの選択肢の中から正しい一次導関数を特定することが求められました。モデルは与えられた関数を理解し、その導関数がどのような特徴を持つべきかを推論する必要がありました。

#### （５）二次関数の導関数の識別

導関数識別タスクの難しいバリアント（派生種）として、二次関数に対応する正しい線形関数（導関数）を4つの選択肢から特定することが求められました。傾きの符号と大きさの両方に注意を払う必要があります。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79686_4-1024x634.png)

few-shotでの二次導関数識別タスクの結果。プロットとテキスト方式の性能比較

### 実世界のタスク

#### （１）IMU（慣性計測装置）データからの転倒検知

スマートフォンやウェアラブルデバイスから得られた慣性計測装置（IMU）のデータが使用されました。IMUは3軸の加速度データと3軸の角速度データからなる6次元の波形を出力します。15秒間のIMU波形セグメントを「転倒」「日常生活動作（ADL）」「ニアフォール（転倒に近い動作）」の3つのクラスに分類することが求められました。

なお「ニアフォール」クラスは、実験参加者が実際には転倒せずに転びかけの動作をするため、IMUに大きな変化が記録される難しい否定例として機能しました。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79686_5-1024x625.png)

転倒検知タスクの結果。1, 3, 5, 10-shotsでの比較

#### （２）IMUデータからの活動認識

15秒間のIMU波形セグメントを「座る」「立つ」「階段」「歩く」「自転車」の5つの活動クラスのいずれかに分類することが求められました。

データセットには、4種類の異なるスマートフォンと2種類のスマートウォッチから収集された不均一なデータが含まれており、クラスのバランスも取れていないため、評価には [F1スコア](https://ai-data-base.com/archives/26112 "F1スコア（F値）") が使用されました。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79686_6-1024x618.png)

活動認識タスクの結果。モデル別のF1スコアを示す。

なお、28日間のトレーニング負荷データを分析してオーバートレーニング状態かアンダートレーニング状態かを判定する二値分類タスクも検証されました。  
下記の図は、データをバープロットとして視覚化した場合と、テキストデータとして扱った場合のF1スコアを、Gemini Flash 1.5とGemini Pro 1.5の2つのモデルで比較しています。興味深いことに、モデルサイズによって結果が分かれ、Gemini Pro 1.5ではプロット方式が若干優位、Gemini Flash 1.5ではテキスト方式が若干優位という結果が出ています。ただし、その差は小さく、論文著者らもこのタスクは表形式データのため、プロット方式の利点が限定的だったと分析しています。

![](https://ai-data-base.com/wp-content/uploads/2024/11/AIDB_79686_7.png)

### コストに関する考察

#### トークン効率性の向上

時系列データに対してプロットを使用することで、コストとトークンの効率性が大幅に改善されることが明らかになりました。

まず、コンテキストが大きく、ウィンドウサイズが制限されている場合に重要性を増すことが分かりました。例えば、GPT4o（-mini）の128kコンテキストウィンドウに生の信号を収めるためには、大規模なfew-shot実験においてダウン [サンプリング](https://ai-data-base.com/archives/26518 "サンプリング") が必要です。そのため画像で入力することでコンテキストをかなり節約することができるのです。

Gemini APIを使用した場合、384 x 384ピクセル未満の画像は258トークンで処理されます。それを超えると4つの追加クロップが必要となり、合計1290トークンとなります。一方、テキストベースのタスクでは簡単に10倍以上のトークン（例：10-shot活動認識で128k以上のコンテキスト）が必要となります。

#### コスト効率の実例

最もコストのかかる実験である few-shot 活動認識を例に取ると、

GPT4oでの5-shot実験をテキスト版で行うと、

- 必要トークン数：約128kテキストトークン
- コスト：1質問あたり$0.32

となります。一方で、プロット版では、

- 必要トークン数：50画像分
- コスト：$0.032

です。計算すると、入力トークンのコストが約10分の1に削減できます。

このように、プロットベースのアプローチでは、性能の向上だけでなく、大幅なコスト削減も実現されることが示されました。

## まとめ

本記事では、時系列データの理解をマルチモーダルLLMに行わせる新しいアプローチについての研究を紹介しました。時系列データを数値の羅列としてではなく、グラフとして視覚化してモデルに提示することが提案されています。

研究の結果、データの全体的なトレンドを理解する必要があるタスクにおいて、このプロットベースのアプローチが優れた性能を示すことが確認されました。さらに、モデルのトークン使用量が大幅に削減され、APIコストの削減にもつながることが実証されています。

このアプローチは追加のモデル学習を必要としないため、既存のマルチモーダルモデルをすぐに活用できるとされています。ただし、表形式のデータなど、少量のデータを扱う場合には、必ずしもプロットが最適な選択とは限らないことも指摘されています。

今後の研究展開として、時系列データの予測への応用や、モデルが自律的にプロットを生成・活用する方向性が検討されており、この分野のさらなる発展が期待されています。

- 参照論文URL： [https://arxiv.org/abs/2410.02637](https://arxiv.org/abs/2410.02637)

**■サポートのお願い  
**AIDBを便利だと思っていただけた方に、任意の金額でサポートしていただけますと幸いです。  

  

[長文コンテキスト処理はRAGを進化させるのか？最新モデル20種類での実験結果](https://ai-data-base.com/archives/79561)

[実際の企業データからなるtext-to-SQLベンチマーク「Spider 2.0」と専門エージェント『Spider-Agent』](https://ai-data-base.com/archives/79831)

 [![](https://ai-data-base.com/wp-content/themes/innovate_hack_tcd025/img/footer/return_top.png) PAGE TOP](https://ai-data-base.com/archives/#header_top)