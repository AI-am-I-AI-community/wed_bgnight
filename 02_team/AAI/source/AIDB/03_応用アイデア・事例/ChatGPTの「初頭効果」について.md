---
title: "ChatGPTの「初頭効果」について"
source: "https://ai-data-base.com/archives/69101"
author:
  - "[[AIDB Research]]"
published: 2024-05-15
created: 2025-06-13
description: "カリフォルニア大学などの研究者らは、ChatGPTが質問に対する回答を選ぶ際に、プロンプト内の情報の順序に影響を受ける「初頭効果」が存在するかどうかを調査しました。実験の結果、さまざまなタスクにおいて初頭効果が確認されました。"
tags:
  - "clippings"
---
**【お知らせ】** AIDB主催のビジネスマッチングイベントを7月25日(金)開催予定です！  
  

\---以下、記事本文---

カリフォルニア大学などの研究者らは、ChatGPTが質問に対する回答を選ぶ際に、プロンプト内の情報の順序に影響を受ける「初頭効果」が存在するかどうかを調査しました。実験の結果、さまざまなタスクにおいて初頭効果が確認されました。

![](https://ai-data-base.com/wp-content/uploads/2024/05/AIDB_69101-1-1024x576.jpg)

**参照論文情報**

- タイトル：Primacy Effect of ChatGPT
- 著者：Yiwei Wang, Yujun Cai, Muhao Chen, Yuxuan Liang, Bryan Hooi
- 所属：University of California, Los Angeles, Nanyang Technological University, University of California, Davis, National University of Singapore, Hong Kong University of Science and Technology (Guangzhou)

**本記事の関連研究** ：

- [LLMにおける超長尺のコンテキスト内学習（In-context learning）とファインチューニングの性能比較](https://ai-data-base.com/archives/68564)
- [プロンプトに例を多く載せるほど、どんなタスクでも性能が上がるのか？DeepMindによる『Many-shot Learning』の実験結果](https://ai-data-base.com/archives/67883)
- [LLMは本当に推論しているか？原理から導かれる長所短所と最適なフレームワーク](https://ai-data-base.com/archives/65459)
- [GPT-4などのLLMが「AはB」から「BはA」を導かない『逆転の呪い』における誤解なき解釈と対策](https://ai-data-base.com/archives/56074)

## 背景

ChatGPTの能力は、人間のテキストに由来しています。そのためChatGPTが人間の認知バイアスも継承している可能性が考えられています。

認知バイアスの一つに「初頭効果」があります。初頭効果とは、先頭に提示された情報を、中央や末尾の情報よりも良く記憶する傾向のことです。人間の注意力や記憶システムに関連している現象だと考えられており、人間関係で言えば初対面の印象がその後に大きく影響すると言われる理由です。

なお広告や検索エンジンにおいても、人間は実際の関連性に関わらず、上位に表示されたアイテムをクリックすることが多くなります。このように初頭効果は人間の広範な行動に影響を与え、不公平な判断を導く可能性があります。もし機械学習モデルにおいても初頭効果が同様に存在すれば、パフォーマンスの低下につながる恐れがあります。

そこで研究者らは、ChatGPTにおける初頭効果の有無を明らかにするべく調査を行いました。ChatGPTが回答の選択肢の中で、先頭に提示された情報を選択する傾向があるかどうかを調べました。

本研究の目的は、ChatGPTの振る舞いをより深く理解し、信頼性の高いChatGPTベースのソリューションを構築するための知見を得ることでした。

## ChatGPTにおける初頭効果の検証方法

本研究では、ChatGPTの初頭効果を分析するために、プロンプト内のラベルの順番を変更する「ラベルシャッフリング」という手法が提案されました。予測の前にラベルの順番をランダムにシャッフルする手法です。ラベルシャッフリングは、プロンプト内の特定のラベル順序が持つ意味的な影響を排除することができます。なお、ここでいう「ラベル」とは、ChatGPTに与える選択肢のことを指します。

理想的には、ラベルの順番に関わらず、モデルは同じ入力に対して常に同じ予測を返すはずです。そのため、ランダムなシャッフリングの下では、本来であれば予測されるラベルのインデックスが一様分布に従うべきです。

研究者らは、ラベルシャッフリングを用いて、ChatGPTを下記2つの方法で分析しました。  
（なお、どんなタスクで実験されたのかは次のセクションで紹介します。）

**（１）インスタンスごとの予測比較**

信頼性が高く一貫性のある [分類器](https://ai-data-base.com/archives/26489 "分類器") は、ラベルの順序に関わらず、同じインスタンスに対して常に同じラベルを選択するはずです。ChatGPTの一貫性を評価するために、同じインスタンスに対してランダムなシャッフリングを2回行い、2つのプロンプトを生成します。プロンプトをChatGPTに入力し、2つの予測を比較します。この処理をすべてのテストインスタンスに適用し、ラベルシャッフリング後に予測が変化したインスタンスの割合を計算します。この割合が高いほど、ChatGPTはラベルの順序に敏感であると言えます。

![](https://ai-data-base.com/wp-content/uploads/2024/05/AIDB_69101_3-1024x324.png)

ロンプト内のラベルをランダムにシャッフルすることで、ChatGPTの初頭効果を分析

**（２）予測インデックスの統計分析**

さらに、ラベルシャッフリング後に予測が変化したインスタンスについて、予測されたラベルのインデックスの分布を統計的に分析します。ChatGPTがラベルの順序に対して何の選好もない場合、予測されたラベルのインデックスは一様分布に従うはずです。ChatGPTの予測ラベルインデックス分布を一様分布と比較することで、ChatGPTの公平性とラベル順序に対する選好を評価することができます。

## 実験と結果

研究者らは、関係抽出タスクと意図検出タスクを用いて、ChatGPTの初頭効果を分析しました。関係抽出タスクや意図検出タスクは意思決定空間が十分に大きいため、ラベルの初頭効果を示すのに適しています。関係抽出タスクでは、TACRED、TACREV、Re-TACREDの3つのベンチマークデータセットを用いました。意図検出タスクでは、Banking77を用いました。さらに、GoEmotionsと20 Newsgroupsのデータセットを用いて、より包括的な評価を行いました。

![](https://ai-data-base.com/wp-content/uploads/2024/05/AIDB_69101_2.png)

ゼロショット意図検出タスクのChatGPTプロンプト例

**各ベンチマーク**

- TACRED：TAC Conference on Automated Knowledge Baseの略で、様々な関係タイプを含む大規模な関係抽出用データセット
- TACREV：TACREDデータセットの改訂版で、 [アノテーション](https://ai-data-base.com/archives/26297 "アノテーション") の品質を向上させたもの
- Re-TACRED：TACREDデータセットを再 [アノテーション](https://ai-data-base.com/archives/26297 "アノテーション") したもので、関係抽出モデルの評価に用いられる
- Banking77：銀行業務に関する77種類の顧客の意図を含む意図検出用データセット
- GoEmotions：Redditから抽出された58,000件のコメントに、27種類の感情カテゴリーとニュートラルの [アノテーション](https://ai-data-base.com/archives/26297 "アノテーション") が付与されたデータセット
- 20 Newsgroups：20のニュースグループに分類された約20,000件のニュースグループ文書のコレクション

**モデル**

実験ではOpenAI API gpt-3.5-turboが使用されました。ChatGPTの出力のランダム性を最小限に抑えるために、temperatureは0.0に設定されました。比較対象として、BERTモデルに [MLP](https://ai-data-base.com/archives/26372 "多層パーセプトロン（MLP）") の分類ヘッドを付けて、ファインチューニングしたモデルが用いられました。

### 一貫性の欠如

実験の結果、ChatGPTはラベルシャッフリングに直面した際の一貫性が低いことが観察されました。TACRED、TACREV、Re-TACREDデータセットのテストインスタンスの85％以上で、ラベルシャッフリング後にChatGPTの予測ラベルが変化しました。Banking77では、インスタンスの35.7％で予測が変化しました。GoEmotionsでは69％以上、MASSIVEと20 Newsgroupsでは30％以上のインスタンスで予測が変化しました。

![](https://ai-data-base.com/wp-content/uploads/2024/05/AIDB_69101_4-1024x129.png)

ラベルシャッフリング後に予測ラベルが変化したインスタンスの割合。

![](https://ai-data-base.com/wp-content/uploads/2024/05/AIDB_69101_5-1024x248.png)

テストインスタンスにおける予測インデックスの累積分布。ラベルシャッフリングを行った上で、(a) TACRED、(b) TACREV、(c) Re-TACRED、(d) Banking77のデータセットで評価。

対照的に、ファインチューニングしたBERT [分類器](https://ai-data-base.com/archives/26489 "分類器") は、ラベルシャッフリング後も一貫した予測を維持しました。この結果は、「ChatGPTがプロンプトの人間の指示を理解し、一貫した応答を提供できる」というのがやや過度な期待であることを示しています。この現象の説明の1つとして、ChatGPTのプロンプト理解が人間のラベル付きデータでの学習によって得られており、異なる位置のラベルを不公平に扱うという人間の認知バイアスを継承していることが考えられます。

関係抽出データセットでは予測が変化したインスタンスの割合が一貫して高かったのに対し、意図検出では低くなっていることも注目に値します。この差は、情報抽出タスクがChatGPTやその他のLLMにとって困難であることに起因すると考えられます。より難しいタスクでは、ChatGPTは入力テキストから十分な意味的理解が得られず、ラベルの順序の影響を受けやすくなるのかもしれません。

### 初頭効果の詳細

今回の実験結果を一言で言うと、「ChatGPTの予測はラベルの順序に影響を受ける」ことを示しています。

研究者らはラベルの順序がChatGPTに与える影響をより深く掘り下げるために、予測されたラベルのインデックスの分布を分析しました。

注目すべきは、ChatGPTの予測分布が一様分布から一貫して逸脱し、データセット全体で小さいインデックスへの一貫したバイアスを示していることです。対照的に、BERTはラベルの順序に対する選好を示さず、予測されたラベルのインデックスの分布は一貫して一様でした。

![](https://ai-data-base.com/wp-content/uploads/2024/05/AIDB_69101_1.png)

ChatGPTの予測ラベルインデックスの密度分布

本研究では、ChatGPTのこの傾向を（冒頭で説明した）初頭効果と呼んでいます。ChatGPTはプロンプトの中で早い段階で提示されたラベルを好む傾向があるのです。初頭効果の大きさはタスクによって異なり、ChatGPTがより難しいタスクに取り組む際に大きくなることが観察されました。

### 公平性の評価

訓練されたモデルの公平性は、予測の不均衡さや偏りを調べることで評価できます。先行研究に倣い、研究者らはJSダイバージェンスを用いて、予測Pがどの程度不均衡/偏っている/不公平であるかを評価しました。

ChatGPTのラベル順序バイアスを評価するために、予測されたラベルインデックス分布Pと一様分布Uの間の平均相対ラベル順序不均衡（LOI）を計算しました。LOIは、予測されたインデックスと一様分布の間の差異を捉えています。

実験の結果、ChatGPTは入力テキストに対する関係ラベルの予測においてラベルインデックスを不公平に扱っていることが示されました。さらに、タスクの難易度が上がるにつれて、不公平性の度合いも上昇することが明らかになりました。他の実験結果と一致する傾向です。対照的に、BERTは予測がラベルの順序に影響を受けないため、はるかに優れた公平性を示しました。

![](https://ai-data-base.com/wp-content/uploads/2024/05/AIDB_69101_6.png)

TACRED、TACRED-Revisit、Re-TACRED、Banking77のテストセットにおける実験結果（不公平性; %）。値が低いほど良い。

さらに、Chain-of-thoughts（CoT）を用いたChatGPTのパフォーマンスもテストしました。CoTを用いた場合でも、ChatGPTは初頭効果を示しました。CoTはLLMに問題についてのゆっくりとした思考を促すものの、推論ステップにおける認知バイアスを必ずしも軽減しないということです。

## まとめ

本記事では、ChatGPTにおける初頭効果（primacy effect）に関する研究を紹介しました。この研究では、LLMの代表例であるChatGPTが、プロンプト内のラベルの位置によって予測結果が影響を受ける可能性が指摘されています。

研究者らは、プロンプト内のラベルの順番をランダムに入れ替える「ラベルシャッフリング」という手法を用いて分析しました。その結果、ChatGPTはラベルの順序に敏感であり、プロンプトの早い段階で提示されたラベルを選択する傾向があることが明らかになりました。さらに、この影響はタスクの難易度が高いほど顕著になることも示されました。

本研究の知見は、ChatGPTの振る舞いをより深く理解し、信頼性の高いChatGPTベースのソリューションを構築するための一助となることが期待されます。ChatGPTを実際のタスクに適用する際には、ラベルの順序による影響を考慮し、適切な対策を講じることが重要だと言えます。

- 参照論文URL： [https://arxiv.org/abs/2310.13206](https://arxiv.org/abs/2310.13206)
- Github： [https://github.com/wangywUST/PrimacyEffectGPT](https://github.com/wangywUST/PrimacyEffectGPT)

**■サポートのお願い  
**AIDBを便利だと思っていただけた方に、任意の金額でサポートしていただけますと幸いです。  

  

[認知症の早期介入にLLMチャットボットが役に立つ　ハーバードなどが検証](https://ai-data-base.com/archives/67581)

[RAGの失敗パターン7選と教訓9箇条](https://ai-data-base.com/archives/69154)

 [![](https://ai-data-base.com/wp-content/themes/innovate_hack_tcd025/img/footer/return_top.png) PAGE TOP](https://ai-data-base.com/archives/#header_top)