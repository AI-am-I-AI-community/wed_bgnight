---
title: "時系列分析におけるLLMの可能性"
source: "https://ai-data-base.com/archives/67378"
author:
  - "[[AIDB Research]]"
published: 2024-04-11
created: 2025-06-13
description: "Microsoftなどの研究者らは、LLMを時系列分析に応用することで、データからより多くの知見を得られるようになるのではないかと考えています。"
tags:
  - "clippings"
---
**【お知らせ】** AIDB主催のビジネスマッチングイベントを7月25日(金)開催予定です！  
  

\---以下、記事本文---

Microsoftなどの研究者らは、LLMを時系列分析に応用することで、データからより多くの知見を得られるようになるのではないかと考えています。

時系列データとは、時間の経過に伴って収集された一連のデータポイントのことで、様々な分野で重要な役割を果たしています。

![](https://ai-data-base.com/wp-content/uploads/2024/04/AIDB_67378-1024x576.jpg)

**参照論文情報**

- タイトル：Position Paper: What Can Large Language Models Tell Us about Time Series Analysis
- 著者：Ming Jin, Yifan Zhang, Wei Chen, Kexin Zhang, Yuxuan Liang, Bin Yang, Jindong Wang, Shirui Pan, Qingsong Wen
- 所属：Monash University, Chinese Academy of Sciences, The Hong Kong University of Science and Technology (Guangzhou), Zhejiang University, East China Normal University, Microsoft Research Asia, Griffith University, Squirrel AI.

## 背景

時系列データは、多岐にわたる分野で使用されています。例えば、金融市場の変動や、交通量の予測などにも活用されています。

これまでの時系列分析技術は、特定の分野に特化したものが多い状況でした。しかしLLMを時系列分析に応用することで、より効率的かつ汎用的な分析が可能になるのではないかと考えられています。

時系列分析モデルは、大きく次の4つの世代に分けられると研究者らは考えています。

**統計モデル(1950年代〜2000年代)** ：小規模なデータを対象とし、ヒューリスティックに基づいたモデル。

**[ニューラルネットワーク](https://ai-data-base.com/archives/26117 "ニューラルネットワーク") モデル(2010年代)** ：大規模で複雑なデータを扱えるようになった。

**事前学習モデル(2022年)** ：大規模な時系列データで事前学習し、少量のデータで特定のタスクに適応できるようになった。

**LLM中心モデル(2024年)** ：LLMを活用することで、予測だけでなく、一般的な知能を持つようになると期待されている。

研究者らは、今後LLMが時系列分析においても重要な役割を果たすことができると想定しています。

時系列データそのものや既存の分析手法を強化できる、優れた予測モデルを構築できる、次世代の時系列分析エージェントとして機能できる、という3つのアプローチに基づく予測です。

以下では、LLMを中心とした手法で時系列データの分析を行うための方法論とメリット、現状の課題などを紹介します。

![](https://ai-data-base.com/wp-content/uploads/2024/04/AIDB_67378_2-1024x414.png)

時系列データ分析のパラダイムシフトを示す図

## 時系列データとはなにか

時系列データには、大きく分けて2つのタイプがあります。1つは、一定の時間間隔で観測された単変量時系列データで、もう1つは、複数の変数を同時に観測した [多変量](https://ai-data-base.com/archives/26367 "多変量") 時系列データです。

単変量時系列データの例には、毎日の気温などがあります。  
また [多変量](https://ai-data-base.com/archives/26367 "多変量") 時系列データは、例えば、気温と湿度を同時に観測したデータなどが該当します。なお [多変量](https://ai-data-base.com/archives/26367 "多変量") 時系列データは、時間的な関係だけでなく、変数間の空間的な関係も考慮する必要があります。そのため、最近では、 [多変量](https://ai-data-base.com/archives/26367 "多変量") 時系列データをグラフ構造で表現する研究も行われています。

時系列分析には、様々なタスクがあります。例えば、将来の値を予測する予測タスク、時系列データをパターンに基づいて分類する分類タスク、異常な事象を検出する異常検知タスク、欠損値を推定する補完タスクなどです。

最近では、モダリティ変換（異なるデータ形式間の変換）や質問応答など、新しいタスクにも取り組まれています。時系列分析は分野横断的で、対話的で、解釈可能なものになりつつあります。

なお時系列分析におけるモダリティ変換は、数値データをテキストデータに変換することなどが挙げられます。

今回研究者らは、時系列データをLLMに入力できるように変換したり、LLMの知識を時系列分析に活用したりする方法を模索しています。下の図は、LLMと時系列分析を統合することで、複雑な現実世界の問題を解決できる可能性が示されています。

![](https://ai-data-base.com/wp-content/uploads/2024/04/AIDB_67378_1.png)

## LLMを活用した時系列分析の強化

LLMを活用した時系列分析の強化手法は、大きく2つに分類されます。

### データベースの強化

LLMを活用したデータベースの強化手法は、時系列データの解釈性を向上させるだけでなく、データの補完にも役立ちます。

**解釈性の向上について**

LLMを使ってデータのパターンや異常をテキストで説明することで、時系列データをより深く理解できるようになります。例えば、 [人の移動データ(LLM-MPE)](https://arxiv.org/abs/2311.17351) 、 [生体信号データ(SignalGPT)](https://www.medrxiv.org/content/10.1101/2023.06.28.23291916v1) 、 [トレンドマイニング(Insight Miner)](https://openreview.net/pdf?id=E1khscdUdH) などの研究があります。

また、センサーデータ(AmicroN)や空間時系列データ(SST)の詳細な分析にもLLMが活用されています。

**データの補完について**

様々なデータソースを統合することで、時系列データの文脈を豊かにし、モデルの [ロバスト](https://ai-data-base.com/archives/26590 "ロバスト") 性を向上させることができます。金融意思決定の研究では、この手法が探求されています。

なお [ロバスト](https://ai-data-base.com/archives/26590 "ロバスト") 性とは、システムが異常や予期せぬ状況に対して、どの程度耐えられるかを表す尺度を指します。

### モデルベースの強化手法

時系列モデルの外部知識やドメイン固有の文脈における制約を解消することを目的とした手法もあります。LLMから知識を転移することで、ドメインモデルが複雑なタスクを処理する性能が向上します。

このアプローチでは、しばしばデュアルタワーモデル（2つのニューラルネットワークを組み合わせたモデル）が採用されます。例えば、 [心電図(ECG)分析では、凍結したLLMを用いたモデルが提案されています。](https://openreview.net/forum?id=UAr59yTUWR2)

また、対照学習を用いて、特定のアラインメントを達成する手法もあります。 [テキストと動画をセンサーデータと整列させるIMU2CLIP](https://arxiv.org/abs/2210.14395) 、 [空間時系列予測を強化するSTLLM](https://arxiv.org/abs/2404.00308) などが代表例です。なお対照学習とは正の例と負の例のペアを用いて、モデルを学習させる手法です。

さらに、時系列分析においても、LLMの推論能力を活用するためにプロンプティング手法が研究されています。例えば、 [交通モデルとLLMを統合して、ユーザーに合わせた意思決定分析を行うTrafficGPT](https://arxiv.org/abs/2403.05822) という研究があります。

### 課題

LLMを活用した時系列分析の強化手法は、時系列データの疎性（データの多くが0である性質）やノイズの問題に効果的に対処できます。また、この技術はプラグアンドプレイ（簡単に取り付けたり取り外したりできるもの）であるため、様々な課題に柔軟に対応できます。

ただし、LLMを強化器として使用すると、大規模なデータセットを扱う際に時間とコストのオーバーヘッドが大きくなるという問題も指摘されています。

## 時系列予測

LLMによる時系列予測は、異常検知などの様々なタスクに取り組むことができます。ただし、データの [サンプリング](https://ai-data-base.com/archives/26518 "サンプリング") や情報の完全性の違いなどの独自の課題があります。

以下では、LLMのパラメータにアクセスできるかどうか（要するにブラックボックスな商用モデルかどうか）に基づいて、チューニングベースの手法とチューニングなしの手法に分類して説明します。

![](https://ai-data-base.com/wp-content/uploads/2024/04/AIDB_67378_3.png)

### チューニングベースの手法

パラメータにアクセス可能なLLMを使用する場合はチューニングベースの手法が使えます。以下の手順で行われます。

1. 時系列データを数値信号とテキストデータに分割し、トークン化する
2. トークン化されたデータをLLMに入力する
3. 追加のタスク層を導入して、様々な分析タスクを実行する

LLMを直接生の時系列データに適用できる可能性は小さいですが、先行研究では、LLMが時系列タスクでも同等の性能を発揮できることが示されています。

ただし元のLLMのパラメータを修正する場合は、壊滅的忘却が起こる可能性があります。これを避けるために、追加の軽量な適応層を導入する方法（ [LoRA](https://arxiv.org/abs/2106.09685) のこと）も検討されています。

※壊滅的忘却とは、新しい情報を学習する際に、過去の情報を忘れてしまう現象のこと

なお [Time-LLM](https://arxiv.org/abs/2310.01728) という研究事例では、テキストデータをプロンプトのプレフィックスとして使用し、入力時系列を言語空間に再プログラムすることで、様々な予測シナリオでのLLMの性能を向上させています。  
また [TEST](https://arxiv.org/abs/2308.08241) という研究事例では、時系列データ用のエンコーダを構築し、アラインメント対比と柔軟なプロンプトを用いて、凍結されたLLMを効率的にファインチューニングしています。

### チューニングなしの予測手法

クローズドソースのモデルを使用する場合は、チューニングなしの予測手法をとることになります。時系列データを前処理してLLMの入力空間に適合させることが手法の中心となります。以下の2つのステップで行われます。

1. 生の時系列データを前処理する（プロンプトの作成やカスタマイズされたトークン化など）
2. 処理された入力をLLMに与え、応答を取得する
3. パース関数を用いて予測ラベルを取得する

LLMのトークナイザーは数値値用に設計されていないため、連続値を分離し、時間的な関係を無視してしまうという問題があります。その問題を解決するために、軽量の埋め込み層とプロンプトエンジニアリングが提案されています。

LLMTimeという研究事例では、トークンを柔軟な連続値に変換することで、チューニングしていないLLMでもゼロショット予測の性能を向上させています。LLMが多様な分布を表現できる能力をもつことによるものだと考えられています。

### その他の手法

上記の手法以外にも、時系列分析のための基盤モデルをスクラッチから構築する手法が考えられます。例えばLLMのスケーリング則（データを増やすほど性能が上がる法則）を尊重した、ドメイン固有の大規模でモデル構築が研究されています。

[PreDcT](https://arxiv.org/abs/2310.10688) という研究事例では、Google Trendsのデータを用いて大規模な時系列 [コーパス](https://ai-data-base.com/archives/26324 "コーパス") を構築し、基盤モデルのアテンション [アーキテクチャ](https://ai-data-base.com/archives/26562 "アーキテクチャ") を変更して時系列予測を行っています。他に、 [Lag-Llama](https://arxiv.org/abs/2310.08278) では、一変量確率時系列予測モデルを導入し、モデルのスケーリング分析にはべき乗則を適用しています。

### 課題

LLMによる時系列予測は、少数ショットやゼロショットでも、ほとんどのドメイン固有モデルを上回る性能を示しています。

チューニングベースの手法は、パラメータを調整できるため、一般的に性能と特定のドメインへの適応性が高くなります。ただし、壊滅的忘却が起こりやすく、パラメータの修正に伴う学習コストが高いという問題があります。アダプター層である程度この問題は軽減されていますが、高価な学習という課題は残っています。

一方、チューニングなしの手法は、手動でのプロンプトエンジニアリングに大きく依存しており、予測の安定性は常に保証されるとは限りません。

また、時系列の基盤モデルをスクラッチから構築するには、高い開発コストと適用可能性のバランスを取る必要があります。

## LLM時系列分析エージェント

前述のように、チューニングベースの手法では特定のドメインに適応させるためにLLMのパラメータを調整します。しかし、その際にはLLMの対話能力が犠牲になりがちです。一方、チューニングなしの手法では、LLMが主にテキストデータで学習しているため、言語では捉えにくい複雑な時系列パターンの理解には限界があります。

上記の課題に対処するため、LLMを汎用的な時系列分析や問題解決のためのエージェントとして直接活用する研究が少数ながら行われています。以下では、様々なモダリティにおけるアプローチの概要を示し、エージェント構築の戦略を説明します。

エージェント関連研究は大きく2つのカテゴリーに分類されます。

**（１）外部知識の統合**

特定のドメインに関するLLMの理解を深めるために、コンテキスト内学習を実現するプロンプトを用います。例えば、物体の説明や関係をプロンプトに埋め込んでLLMの画像クエリ分析を支援したり、交通状態、天気、道路の種類を含むプロンプトを用いてドメインに基づく推論を行ったりします。

なお、時系列の知識をLLMに組み込むための3つの異なる方向性が提案されています。時系列の特徴と言語モデルの表現を明示的に整列させるアプローチ（下図のa）、テキストの埋め込みと時系列の特徴を融合させるアプローチ（下図のb）、そしてLLMに外部の事前学習済み時系列モデルの利用方法を教えるアプローチです（下図のc）。

![](https://ai-data-base.com/wp-content/uploads/2024/04/AIDB_67378_5.jpg)

時系列の知識をLLMに組み込むための3つの異なる方向性

**（２）LLMを目的のモダリティのコンテンツに適合させる**

エージェント研究のもう一つのテーマとして、LLMがAPIコールでデータセットに [アノテーション](https://ai-data-base.com/archives/26297 "アノテーション") を付けられるようにし、様々なツールの使用に合わせてファインチューニングを行うといった内容があります。  
なお、GPT-4を使用してマルチモーダルな言語-画像の指示データを生成したり、金融分野向けのマルチタスク指示データセットを作成したりする研究もあります。

### 実験と考察

今回研究者らは、基本的な時系列分析タスクの実行をサポートするようにLLMにプロンプトを与える実験を行いました。その結果、LLMが時系列エージェントとして機能する可能性を秘めていることが示唆されたとのことです。ただし、複雑な時系列データの理解には限界があり、ハルシネーションを生成する傾向があることも示されました。

今後の研究では、LLMの固有のゼロショット能力を活用して、一般的なパターン操作を行うことに重点を置くべきだと研究者らは提案しています。コンテキスト内学習を通じて一般的な時系列問題を解決するためのフレームワークを確立することが有望だと述べています。

### 課題

ハルシネーションの問題に対処するためには、しっかりとプロンプトを設計することと、信頼できる指示データセットを用いたモデルのファインチューニングが求められます（ただし、多大な人的努力が必要であり、スケーラビリティと効率性の面で課題があります）。

また、時系列エージェントを人間の好みに合わせることも重要な課題です。例えば、役立つコンテンツを生成しつつ、有害なコンテンツを避けるようにエージェントを調整する必要があります。

さらに、時系列データは絶えず変化しているため、エージェントが新しい知識を継続的に獲得したり、コストがかかる再学習を必要とせずに生涯学習パターンを採用したりできるようにするといった工夫が重要です。

## まとめ

本記事では、LLMを活用した時系列分析に関する論文を紹介しました。

研究者らは、LLMが時系列分析において今後中心的な役割を果たすことができると述べています。時系列データの拡張器、予測器、エージェントとして機能する普遍的なツールになるだろうとのことです。その主張を裏付ける文献が今回いくつか紹介されました。

以上のように、LLMを活用した時系列分析の可能性は期待されています。今後も注目していきたいですね。

- URL： [https://arxiv.org/abs/2402.02713](https://arxiv.org/abs/2402.02713)

**■サポートのお願い  
**AIDBを便利だと思っていただけた方に、任意の金額でサポートしていただけますと幸いです。  

  

[ChatGPTと実際に交わされた会話の世界最大規模データセット「WildChat」](https://ai-data-base.com/archives/67317)

[Claude 3などのLLMはコンテキスト内学習によって線形回帰・非線形回帰問題タスクもこなす](https://ai-data-base.com/archives/67496)

 [![](https://ai-data-base.com/wp-content/themes/innovate_hack_tcd025/img/footer/return_top.png) PAGE TOP](https://ai-data-base.com/archives/#header_top)