---
title: "マルチエージェントによる自動カウンセリングシステム"
source: "https://ai-data-base.com/archives/82682"
author:
  - "[[AIDB Research]]"
published: 2025-01-24
created: 2025-06-13
description: "本記事では、対面カウンセリングのアクセス障壁を解消する試みとして、LLMベースの自律型カウンセリングシステムの研究を紹介します。"
tags:
  - "clippings"
---
**【お知らせ】** AIDB主催のビジネスマッチングイベントを7月25日(金)開催予定です！  
  

\---以下、記事本文---

本記事では、対面カウンセリングのアクセス障壁を解消する試みとして、LLMベースの自律型カウンセリングシステムの研究を紹介します。

認知行動療法（CBT）は心理カウンセリングにおいて有効性が実証されている手法ですが、羞恥心から支援を求めることができない人々も多く存在します。そこでLLMによる自動カウンセリングが期待されています。

![](https://ai-data-base.com/wp-content/uploads/2025/01/AIDB_82682-1024x576.png)

**発表者情報**

- 研究者：Ancheng Xu et al.
- 研究機関：深圳先進技術研究院, 中国科学院, 中国科学院大学, 中国科学技術大学, マカオ大学, 深圳大学, 深圳北理モスクワ大学, ハルビン工業大学

論文情報詳細は記事の下部に記載されています。

## 背景

心理カウンセリングで使用されることが多い手法として認知行動療法があります。人間の認知における論理的な誤り（破局的思考、レッテル貼り、肯定的な事象の過小評価など）に着目し、それらが日常生活や生活の質に与える影響を軽減することを目指す手法です。効果が実証されており広く活用されています。

一方で、対面での心理カウンセリングによる認知行動療法は、羞恥心から支援を求めることを躊躇する人々も数多く存在します。

そんな中、LLMの発展は、心理カウンセリングの自動化における期待ももたらしつつあります。

しかし、既存の自動カウンセリングシステムには、固定的な構造による自己最適化能力の限界や、パターン化された応答による表面的なアドバイスに留まるといった課題が指摘されています。

そこで今回研究者たちは、状況に応じて柔軟に対応し、自律型マルチエージェントシステムを開発しました。利用者の考え方のクセや偏りを見つけて分析し、より質の高い心理カウンセリングを目指す試みです。

以下で詳しく紹介します。

![](https://ai-data-base.com/wp-content/uploads/2025/01/AIDB_82682_1-2-1024x500.png)

今回考案されたAutoCBTフレームワークの概要図。ユーザーからの質問を受けた際のカウンセラーの動作フローを示す。スーパーバイザーへの相談プロセスや最終レスポンスの生成までの流れを図示している。

## 方法論

研究チームは、カウンセラーの専門知識や判断プロセスを組み込んだLLMシステムの開発に取り組みました。心理カウンセリングを自動化する上で重要となるのは、対話の質を維持しながら適切な支援を提供する仕組みです。

システムの概要としては、複数のエージェントが協調して動作する自律型のフレームワークです。メインとなるカウンセラーエージェントと、専門知識を持つ複数の監督エージェントで構成されています。

カウンセラーエージェントは利用者との対話を担当し、必要に応じて監督エージェントに助言を求めることができます。

### 認知行動療法の原則の実装

認知行動療法で重視される5つの原則が、それぞれ監督エージェントに割り当てられます。

5つの原則は以下のとおりです。

- 共感と理解
- 重要な思考や信念の特定
- 振り返りと問いかけ
- 戦略や洞察の提供
- 励ましと予見

![](https://ai-data-base.com/wp-content/uploads/2025/01/AIDB_82682_3.png)

CBTの中核的原則に基づく6つの自動評価指標とそのスコアリング基準を示したもの。

カウンセラーエージェントは、利用者からのメッセージを受け取ると、これらの原則に基づいて適切な監督エージェントへの相談を判断します。

![](https://ai-data-base.com/wp-content/uploads/2025/01/AIDB_82682_1-1-1024x507.png)

エージェント アーキテクチャ のイメージ（AIDBが作成）

メッセージの処理フローは以下のとおりです。

（１）カウンセラーエージェントは利用者からのメッセージを受け取ると、まず動的ルーティングを実行します。 なお、以下の要素を考慮してルーティングを決定します。

- メッセージの感情的な強度
- 認知の歪みの複雑さ
- 過去の対話履歴
- 直近の応答の評価結果

（２）ルーティングの結果、以下のいずれかのパスを選択します。

- 直接応答：カウンセラーが単独で応答を生成
- 助言依頼：1つ以上の監督エージェントに助言を求める

（３）監督エージェントはそれぞれ以下の役割で応答を評価・改善します。

- 共感と理解エージェント：感情への理解と共感の表現を評価
- 思考特定エージェント：認知の歪みのパターンを特定
- 振り返りエージェント：利用者の思考を促す問いかけを提案
- 戦略提供エージェント：具体的な対処方法を提案
- 励ましエージェント：前向きな取り組みを促す表現を追加

（４）監督エージェントからの助言は応答レビューで統合され、カウンセラーエージェントが最終的な応答を生成します。

なお、実際の実装において重要となる具体的なプロンプトの内容や、各エージェント間のメッセージフォーマット、監督エージェントの判断基準などの詳細情報は公開されていません。そのため、同等のシステムを完全に再現することは困難です。

代替案として、基本 [アーキテクチャ](https://ai-data-base.com/archives/26562 "アーキテクチャ") の情報をベースに、認知行動療法の原則に基づいて独自のプロンプトを設計し、段階的に改善を重ねていく方法が考えられます。メッセージの感情的な強度や認知の歪みの複雑さといった判断基準も示されているため、これらを参考に実装を進めることは可能です。

### 評価のための2言語対応データセットについて

システムの評価のため、中国語と英語の心理カウンセリングデータを収集し、10種類の認知の歪みに分類したデータセットが作成されました。各言語100件の質問と回答のペアで構成され、実際のカウンセリング事例に基づいています。

実際には、既存のカウンセリング向けデータセットPsyQAとTherapistQAから事例を抽出し、質問と説明を統合して利用者からの相談として再構成されました。言語モデルを用いて認知の歪みを分析し、各カテゴリから10件ずつ選択することで、バランスの取れたデータセットが実現されています。

![](https://ai-data-base.com/wp-content/uploads/2025/01/AIDB_82682_2-1024x627.png)

二言語データセットの構造と質疑応答例を示したもの。

### 実験設定

心理カウンセリングのオンライン化においては、微妙な感情の変化や指示への対応が重要視されます。

実験では中国語と英語の両方について、Qwen-2.5-72BとLlama-3.1-70Bという2種類の言語モデルが使用されました。温度パラメータは0.98に設定され、それ以外はデフォルト設定が採用されています。

#### 比較対象となる手法

基準となる手法として、単純な生成（Generation）とCBTの原則を組み込んだプロンプト生成（PromptCBT）が選択されました。

AutoCBTは2段階のプロセスで動作し、まず下書き応答を生成し、必要に応じて監督エージェントからの助言を受けて最終的な応答を作成します。

### 評価方法

#### ①自動評価

GPT-4o-miniによる自動採点が実施され、6つの観点（共感性、認知の歪みの特定、振り返り、戦略、励まし、関連性）から7点満点で評価されました。応答の再現性を確保するため、各応答について3回の評価が行われ、平均値が採用されています。

#### ②人間による評価

2種類の人間による評価が実施されました。簡易総合評価では、5名の心理学の専門家がデータセット全体を確認し、AutoCBTと基準手法の回答を比較しました。詳細 [サンプリング](https://ai-data-base.com/archives/26518 "サンプリング") 評価では、6名の専門家が全体の10%にあたる60の応答について、7つの観点から詳細な分析を行いました。

人間による評価では、認知の歪みの特定と修正に重点が置かれ、カウンセリング技術の適切な統合についても検証されました。

## 実験結果

方法論セクションで説明された評価方法に基づき、AutoCBTの性能が検証されました。実験では言語モデルの種類や言語の違いによる影響も含めて、包括的な評価が行われています。

結論から言うと、AutoCBTは基準手法と比較して、より高品質な自動カウンセリングサービスを提供できることが示されています。

### 中国語データセットでの評価結果

Qwen-2.5-72Bを用いた中国語での実験では、AutoCBTが6つの評価指標のうち5つで最高スコアを記録しました。単純な生成手法と比較すると、認知の歪みの特定や振り返りの質において顕著な改善が見られました。7点満点での総合スコアは、AutoCBTが37.460点、PromptCBTが36.460点、単純生成が32.300点となっています。

### 英語データセットでの評価結果

英語での実験では、QwenモデルとLlamaモデルの両方で評価が実施されました。Qwenモデルを使用した場合、AutoCBTは全ての評価指標で最高スコアを達成し、総合スコアは38.377点を記録しました。一方、Llamaモデルでは一部の繊細な質問に対して回答を控える傾向が観察されました。

![](https://ai-data-base.com/wp-content/uploads/2025/01/AIDB_82682_4-1024x261.png)

Qwen-2.5-72Bモデルの二言語データセットにおけるパフォーマンス評価結果。

![](https://ai-data-base.com/wp-content/uploads/2025/01/AIDB_82682_5-1024x175.png)

Llama-3.1-70Bモデルの英語データセットにおけるパフォーマンス評価結果。

### 人間による評価の結果

#### 簡易的な総合評価

5名の心理学専門家による評価では、データセット全体の70%以上の質問において、AutoCBTの回答が最も適切と判断されました。専門家からは、特に共感性の表現と認知の歪みへの対処方法について高い評価が得られています。

#### 詳細な分析結果

専門家による詳細評価では、以下のような具体的な特徴が明らかになりました。言語選択においてAutoCBTは柔軟性を示し、中国語では敬意と傾聴を重視し、英語では専門性を強調する傾向が見られました。また、認知の歪みの指摘方法について、PromptCBTが学術的な表現を用いる一方で、AutoCBTはより日常的な言葉で説明を行い、利用者の理解を促進していました。

![](https://ai-data-base.com/wp-content/uploads/2025/01/AIDB_82682_6-1024x467.png)

AutoCBTが二言語データセットの70%以上の質問において、PromptCBTやGenerationよりも優れた回答を生成できることを示すグラフ。

![](https://ai-data-base.com/wp-content/uploads/2025/01/AIDB_82682_7-1024x273.png)

AutoCBTのドラフトレスポンスとPromptCBTのレスポンス、および最終レスポンスの品質スコアの差異を示したもの。

### システムの課題

#### 同時ルーティングの問題

カウンセラーエージェントが利用者との対話と監督エージェントへの相談を同時に行おうとする状況が発生しました。解決策として、両方の対象が選択された場合は対話を終了するように設定が調整されています。

#### 役割の混乱

監督エージェントが助言ではなく直接回答を生成してしまうケースが確認されました。対策として、監督エージェントの発言開始時に「カウンセラーの皆様へ」という前置きを追加し、役割を明確化しています。

#### Llamaモデルの保守的な傾向

Llamaモデルは未成年者、性的内容、自殺に関連する9つの質問への回答を控えました。一方、Qwenモデルは全ての質問に対応しています。実用化に向けては、適切なバランスの検討が必要とされています。

![](https://ai-data-base.com/wp-content/uploads/2025/01/AIDB_82682_8-1024x247.png)

Qwen-2.5-72BとLlama-3.1-70Bの回答拒否状況の分析結果。

## まとめ

本記事では、認知行動療法に基づく自律型マルチエージェントフレームワーク「AutoCBT」の研究を紹介しました。

動的なルーティングと監督メカニズムを導入することで、従来の言語モデルベースのカウンセリングシステムと比較して対話の質が向上することが示されています。

一方で、同時ルーティングや役割の混乱といった技術的課題も明らかになり、実用化に向けては更なる改善が必要とされています。

**参照文献情報**

- タイトル：AutoCBT: An Autonomous Multi-agent Framework for Cognitive Behavioral Therapy in Psychological Counseling
- URL： [https://arxiv.org/abs/2501.09426](https://arxiv.org/abs/2501.09426)
- 著者：Ancheng Xu, Di Yang, Renhao Li, Jingwei Zhu, Minghuan Tan, Min Yang, Wanxin Qiu, Mingchen Ma, Haihong Wu, Bingyu Li, Feng Sha, Chengming Li, Xiping Hu, Qiang Qu, Derek F.Wong, Ruifeng Xu
- 所属：Shenzhen Institutes of Advanced Technology, Chinese Academy of Sciences, University of Chinese Academy of Sciences, University of Science and Technology of China, University of Macau, Shenzhen University, Shenzhen MSU-BIT University, Harbin Institute of Technology

## 理解度クイズ（β版）

1\. この研究で開発されたシステムの主な目的は何ですか？

対面カウンセリングでは羞恥心から支援を求められない人々が多く存在する問題点がある。システムはそのアクセス障壁を解消するために開発された。

解説を見る

2\. 既存の自動カウンセリングシステムの課題として挙げられているのは？

既存システムは固定的な構造による自己最適化能力の限界があり、パターン化された表面的なアドバイスに留まる問題がある。より柔軟な対応が求められている。

解説を見る

3\. このシステムで採用されている主要な心理療法の手法は？

システムは認知行動療法（CBT）をベースにしている。人間の認知における論理的な誤りに着目し、その影響を軽減することを目指す。

解説を見る

4\. 新しく開発されたシステムの特徴として正しいものは？

状況に応じて柔軟に対応し、自律型マルチエージェントシステムとして機能する。利用者の考え方のクセや偏りを分析する能力を持つ。

解説を見る

5\. 研究チームはどこの機関に所属していますか？

深圳先進技術研究院、中国科学院、マカオ大学など中国を中心とするアジアの研究機関が参加している。研究は国際的な協力体制で実施された。

解説を見る

**■サポートのお願い  
**AIDBを便利だと思っていただけた方に、任意の金額でサポートしていただけますと幸いです。  

  

[LLMエージェント間で観察された人間のような「意見の二極化」](https://ai-data-base.com/archives/82487)

[三段論法でLLMの推論能力を高める　プロンプト手法の新提案](https://ai-data-base.com/archives/82746)

 [![](https://ai-data-base.com/wp-content/themes/innovate_hack_tcd025/img/footer/return_top.png) PAGE TOP](https://ai-data-base.com/archives/#header_top)